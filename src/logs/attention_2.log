Namespace(attention=1, batch_size=16, build_starspace=0, cbow=0, embed_dim=50, exp_name='attention_2.pth', focalloss=1, gpu_id=1, hidden_dim=100, log_interval=100, lr=0.001, lr_decay_epoch=10, lr_decay_rate=0.9, model_file='newdata_attention_2.pth', num_epochs=20, num_workers=4, train_path='/misc/vlgscratch2/LecunGroup/laura/medical_notes/processed_data/10codesL5_UNK_content_2_top1_train_data.pkl', use_starspace=1, val_path='/misc/vlgscratch2/LecunGroup/laura/medical_notes/processed_data/10codesL5_UNK_content_2_top1_valid_data.pkl', vocab_threshold=5)
('Train size:', 7793)
('Valid size:', 973)
Counter({'41401': 2085, '0389': 1440, '41071': 1062, '51881': 772, '4241': 755, '431': 617, '486': 466, 'V3001': 270, 'V3101': 166, 'V3000': 160})
('Vocab size:', 2288)
['<PAD>', 'UNK', '', 'limited', 'oxygenation', '-cad', 'hypercholesterolemia', 'implants', 'powders', 'narcotic', 'four', 'obstruction', 'sleep', 'fibrillation/flutter', 'valvuloplasty', 'poorly', 'klebsiella', 'increase', 'feeding', 'coarctation']
====================== Data examples =======================
['114787', [['discharge', 'diagnosis', ':', 'coronary', 'artery', 'disease', 's/p', 'coronary', 'artery', 'bypass', 'grafting', 'times', 'd', ';', 'left', 'internal', 'mammary', 'artery', 'graft', 'to', 'left', 'anterior', 'descending', ',', 'reverse', 'saphenous', 'vein', 'grafts', 'to', 'the', 'ramus', 'intermedius', ',', 'marginal', 'branch', ',', 'right', 'coronary', 'artery', 'a']], '41401']
=============================================================
['145754', [['discharge', 'diagnosis', ':', 'cad', 'pvd', 'htn', 'hyperlipidemia', 'gout', 'metabolic', 'syndrome', 'UNK', 'morbid', 'obesity', 'dm', 'gerd', 'tia', 'left', 'carotid', 'disease', 'sleep', 'apnea', 'ppm', 'for', 'symptomatic', 'bradycardia', 'tonsillectomy', 'lle', 'bypass', 'postop', 'a', 'fib', 'discharge', 'condition', ':', 'good'], ['']], '41401']
=============================================================
['144708', [['discharge', 'diagnosis', ':', 'sepsis', 'vaginal', 'UNK', 'pancytopenia', 'urinary', 'tract', 'infection', 'discharge', 'condition', ':', 'good', 'discharge', 'instructions', ':', 'you', 'will', 'be', 'followed', 'by', 'the', 'UNK', 'at', 'the', 'rehab', 'facility'], ['if', 'you', 'have', 'any', 'concerns', ',', 'UNK', 'can', 'UNK', 'UNK'], ['']], '0389']
=============================================================
['199391', [['discharge', 'diagnosis', ':', 'primary', 'diagnoses', ':', 'post-obstructive', 'pneumonia', 'seconday', 'diagnoses', ':', 'squamous', 'cell', 'lung', 'cancer', 'discharge', 'condition', ':', 'mental', 'status', ':', 'clear', 'and', 'coherent'], ['level', 'of', 'consciousness', ':', 'alert', 'and', 'interactive'], ['activity', 'status', ':', 'ambulatory', '-', 'i']], '486']
=============================================================
['145202', [['discharge', 'diagnosis', ':', 'respiratory', 'failure', 'pneumonia', ',', 'UNK', 'nos', 'chronic', 'obstructive', 'pulmonary', 'disease', 'discharge', 'condition', ':', 'deceased', 'discharge', 'instructions', ':', 'none', 'followup', 'instructions', ':', 'none']], '0389']
=============================================================
['167256', [['discharge', 'diagnosis', ':', 'intracerebral', 'hemorrhage', 'discharge', 'condition', ':', 'dead']], '431']
=============================================================
['114078', [['discharge', 'diagnosis', ':', 'aortic', 'stenosis', 's/p', 'redo-sternotomy', ',', 'aortic', 'valve', 'replacment', 'pmh', ':', 'coronary', 'artery', 'disease', 's/p', 'coronary', 'artery', 'bypass', 'graft', ',', 'hyperlipidemia', ',', 'hypertension', ',', 'chronic', 'UNK', 'leukemia', ',', 'gastroesophageal', 'reflux', 'disease', ',', 'st']], '4241']
=============================================================
['165284', [['discharge', 'diagnosis', ':', 'd'], ['term', 'newborn', 'd'], ['small', 'for', 'gestational', 'age', 'd'], ['status', 'post', 'hypoglycemia', 'd'], ['status', 'post', 'physiologic', 'hyperbilirubinemia', ',', 'm'], ['d'], ['[**md', 'n']], 'V3001']
=============================================================
['148154', [['discharge', 'diagnosis', ':', 'primary', ':', 'chf', 'cad', 'resp', 'failure', 'secondary', ':', 'esrd', 'copd', 'dmd', 'discharge', 'condition', ':', 'stable', 'discharge', 'instructions', ':', 'please', 'take', 'all', 'medications', 'as', 'prescribed'], ['seek', 'medical', 'attention', 'immediately', 'if', 'you', 'experience', 'symptoms', 'including', 's']], '41071']
=============================================================
['126879', [['discharge', 'diagnosis', ':', 'cardiogenic', 'shock', 'septic', 'shock', 'acute', 'on', 'chronic', 'kidney', 'injury', 'discharge', 'condition', ':', 'expired', 'discharge', 'instructions', ':', 'expired', 'followup', 'instructions', ':', 'expired', '[**la']], '0389']
=============================================================
=============================================================
['', 'limited', 'oxygenation', '-cad', 'hypercholesterolemia', 'implants', 'powders', 'narcotic', 'four', 'obstruction', 'sleep', 'bypas', 'valvuloplasty', 'poorly', 'klebsiella', 'paroxysmal', 'feeding', 'coarctation', 'plavix', 'ventral']
{'41071': 0, 'V3001': 9, '0389': 2, '4241': 3, '51881': 8, 'V3101': 5, '486': 6, '41401': 1, 'V3000': 4, '431': 7}
[2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 1134, 14, 15, 16, 750, 18, 19, 20, 21]
Label mix training data
Counter({'41401': 2085, '0389': 1440, '41071': 1062, '51881': 772, '4241': 755, '431': 617, '486': 466, 'V3001': 270, 'V3101': 166, 'V3000': 160})
Label mix valid data
Counter({'41401': 243, '0389': 206, '41071': 136, '51881': 89, '4241': 88, '431': 80, '486': 57, 'V3001': 30, 'V3000': 25, 'V3101': 19})
13208
51
<type 'dict'>
Embeddings loaded
('', array([ -5.58568000e-03,  -3.57529000e-03,  -1.12471000e-03,
        -4.98128000e-03,  -4.31956000e-03,  -5.64025000e-03,
        -3.71513000e-03,   7.78788000e-04,  -4.71359000e-04,
        -3.28333000e-03,  -3.73827000e-04,  -4.65486000e-03,
         4.93558000e-04,   4.21067000e-03,  -4.25178000e-03,
        -1.76577000e-03,   4.73828000e-03,   1.54215000e-03,
        -6.47415000e-03,   8.39352000e-04,  -5.61413000e-04,
         3.22060000e-03,  -7.22899000e-05,   2.16527000e-03,
        -1.40206000e-04,  -4.37053000e-03,   4.23560000e-04,
        -1.11617000e-03,   4.51826000e-03,  -2.50370000e-04,
        -5.34544000e-05,   2.60362000e-03,   2.25863000e-03,
        -3.27851000e-03,   1.08270000e-03,   4.70688000e-03,
        -5.37211000e-03,   1.93304000e-03,   7.69165000e-03,
         3.79070000e-03,   1.17437000e-03,   2.37817000e-03,
         3.81363000e-03,   2.82852000e-03,   7.19775000e-03,
        -5.04047000e-04,   1.24476000e-04,   3.36864000e-03,
         5.18095000e-03,   3.84774000e-05]))
('elevation)', array([-0.0167936 ,  0.0129389 ,  0.00634951, -0.00571457,  0.0238086 ,
       -0.00179271, -0.00918471,  0.00719655,  0.0290287 , -0.0152088 ,
       -0.0162745 ,  0.00165059, -0.041395  ,  0.0127128 , -0.0358891 ,
       -0.0113693 ,  0.00435486, -0.00516296,  0.00397296,  0.00153432,
        0.00255779,  0.00925621,  0.00132788, -0.00514505,  0.00080028,
        0.0101301 , -0.0025252 ,  0.00115921, -0.00452952,  0.00831373,
       -0.00857943,  0.00095617,  0.0232685 ,  0.00866925, -0.00951614,
        0.0144192 , -0.0101087 ,  0.0168133 , -0.00591199,  0.00183277,
       -0.00871566, -0.0146989 , -0.015784  , -0.0112815 , -0.00364662,
       -0.0021494 , -0.0142092 , -0.00846238,  0.00049025, -0.0120894 ]))
('pacemaker', array([-0.00263758,  0.00516859, -0.0171979 ,  0.0100818 , -0.00115922,
       -0.00423109,  0.00029695,  0.0149546 ,  0.00818783, -0.0231162 ,
        0.0103106 , -0.0106168 , -0.00031205,  0.00130369,  0.0023231 ,
       -0.00827475,  0.0042188 ,  0.00740185, -0.0105918 , -0.0051116 ,
       -0.00135011,  0.0111367 , -0.00385249, -0.00257517, -0.00551682,
        0.0117559 ,  0.00564071, -0.00452333, -0.00874829, -0.00208852,
        0.00242421, -0.00075785,  0.00769986, -0.00223687, -0.00329498,
        0.00712558,  0.00089059,  0.00541839, -0.00352701,  0.00536203,
        0.00663314, -0.00207932,  0.0007805 , -0.00010857, -0.00471041,
        0.00529625,  0.00552641,  0.00475922,  0.00328143,  0.0063832 ]))
('dmg/hr', array([-0.0148137 , -0.00640395,  0.00173752, -0.035683  , -0.0073231 ,
       -0.00754622, -0.0122305 , -0.0353211 , -0.00473574, -0.00189436,
        0.00419301,  0.00499843, -0.0146347 ,  0.00582408, -0.00037058,
       -0.00298797, -0.0202093 , -0.00053174, -0.0163033 , -0.0259719 ,
       -0.00927689, -0.0226584 ,  0.00891389,  0.0262943 ,  0.00785014,
        0.0101794 ,  0.00063363,  0.015846  ,  0.0190713 , -0.0190074 ,
        0.0155234 , -0.0008695 ,  0.0155494 ,  0.0123736 ,  0.00121591,
       -0.00170613,  0.00314928,  0.0090563 ,  0.0199215 ,  0.0197135 ,
        0.0242564 , -0.0213831 , -0.0162439 ,  0.0118931 ,  0.00808033,
        0.0177265 , -0.00988786, -0.00041203, -0.031992  ,  0.00979616]))
Embedding matrix size torch.Size([2288, 50])
2133 embeddings of a total of 2286 initialized with starspace embeddings
Embedding matrix created
Data Loaded in 0.04 mns.
data loader done
Using hierachical attention model
HANModel (
  (word_rnn): WordModel (
    (word_embed): Embedding(2288, 50)
    (word_rnn): GRU(50, 100, bidirectional=True)
  )
  (wordattention): Attend (
    (lin): Linear (200 -> 200)
    (sm): Softmax ()
  )
  (sent_rnn): SentModel (
    (sent_rnn): GRU(200, 200, bidirectional=True)
  )
  (sentattention): Attend (
    (lin): Linear (400 -> 400)
    (sm): Softmax ()
  )
  (clf): Classifer (
    (lin): Linear (400 -> 10)
  )
)
Model embeddings initialized with starspace
Using focal loss
Starting training...
(122, 973)
Epoch: 0, Step: 0, Train Loss: 19.27, Val Loss: 1.07, Val acc: 0.125
Param Norm1: 28543.23, grad Norm1: 136.33, Param Norm12: 36.83, grad Norm2: 1.00
(305, 973)
Epoch: 0, Step: 100, Train Loss: 5.19, Val Loss: 0.30, Val acc: 0.313
Param Norm1: 29474.48, grad Norm1: 78.65, Param Norm12: 38.04, grad Norm2: 1.00
(183, 973)
Epoch: 0, Step: 200, Train Loss: 4.62, Val Loss: 0.29, Val acc: 0.188
Param Norm1: 30091.37, grad Norm1: 75.10, Param Norm12: 38.77, grad Norm2: 1.00
(244, 973)
Epoch: 0, Step: 300, Train Loss: 4.54, Val Loss: 0.28, Val acc: 0.251
Param Norm1: 31211.01, grad Norm1: 70.60, Param Norm12: 40.37, grad Norm2: 1.00
(610, 973)
Epoch: 0, Step: 400, Train Loss: 4.15, Val Loss: 0.16, Val acc: 0.627
Param Norm1: 35499.98, grad Norm1: 99.28, Param Norm12: 47.74, grad Norm2: 1.00
('LR changed to', 0.0009000000000000001)
Evaluating on training set
Processed 0 batches
(Variable containing:
 0.0819  0.0972  0.0659  0.5583  0.0124  0.0054  0.0718  0.0059  0.0905  0.0107
 0.2796  0.4438  0.0257  0.0907  0.0136  0.0098  0.0449  0.0470  0.0327  0.0121
 0.0813  0.0380  0.2964  0.0286  0.0638  0.0546  0.1242  0.1169  0.1154  0.0806
 0.2680  0.4907  0.0225  0.0759  0.0120  0.0087  0.0394  0.0446  0.0278  0.0105
 0.0851  0.0452  0.2898  0.0701  0.0413  0.0289  0.1695  0.0461  0.1793  0.0446
 0.0564  0.0267  0.3856  0.0332  0.0473  0.0370  0.1450  0.0643  0.1477  0.0568
 0.0886  0.0461  0.2862  0.0618  0.0448  0.0322  0.1650  0.0576  0.1687  0.0490
 0.0754  0.0984  0.0516  0.6175  0.0105  0.0043  0.0573  0.0049  0.0713  0.0089
 0.0979  0.0413  0.2111  0.0229  0.0884  0.0941  0.1055  0.1239  0.0897  0.1251
 0.2714  0.4792  0.0231  0.0789  0.0124  0.0091  0.0403  0.0459  0.0287  0.0109
 0.0752  0.1119  0.0457  0.6252  0.0097  0.0039  0.0520  0.0047  0.0636  0.0080
 0.2969  0.3805  0.0321  0.1043  0.0160  0.0114  0.0543  0.0487  0.0414  0.0143
 0.0677  0.0931  0.0487  0.6446  0.0096  0.0038  0.0532  0.0041  0.0671  0.0080
 0.0503  0.0215  0.0422  0.0033  0.0329  0.0332  0.0219  0.7384  0.0142  0.0421
 0.0354  0.0162  0.4881  0.0297  0.0443  0.0330  0.1230  0.0446  0.1312  0.0544
 0.0492  0.0185  0.0996  0.0075  0.1515  0.2408  0.0386  0.0412  0.0298  0.3233
[torch.cuda.FloatTensor of size 16x10 (GPU 1)]
, 
 3
 1
 2
 1
 2
 2
 2
 3
 2
 1
 3
 1
 3
 7
 2
 9
[torch.cuda.LongTensor of size 16 (GPU 1)]
, Variable containing:
 3
 1
 2
 1
 6
 8
 6
 3
 2
 1
 3
 2
 3
 7
 2
 4
[torch.cuda.LongTensor of size 16 (GPU 1)]
)
Processed 100 batches
Processed 200 batches
Processed 300 batches
Processed 400 batches
4939/7792 correct, 0.634%, avg loss: 2.65676775972
Evaluating on validation set
Processed 0 batches
(Variable containing:
 0.2714  0.4852  0.0225  0.0779  0.0120  0.0087  0.0394  0.0441  0.0282  0.0105
 0.0920  0.0683  0.1458  0.3384  0.0217  0.0105  0.1284  0.0107  0.1645  0.0198
 0.0444  0.0186  0.0407  0.0028  0.0285  0.0278  0.0198  0.7689  0.0127  0.0358
 0.0709  0.0315  0.3047  0.0202  0.0589  0.0497  0.1155  0.1685  0.1063  0.0738
 0.0651  0.0307  0.3633  0.0380  0.0441  0.0335  0.1560  0.0586  0.1590  0.0516
 0.0464  0.0189  0.0472  0.0030  0.0344  0.0340  0.0212  0.7363  0.0141  0.0445
 0.2603  0.4359  0.0289  0.1159  0.0136  0.0092  0.0484  0.0382  0.0376  0.0120
 0.0366  0.0149  0.0552  0.0051  0.1614  0.2703  0.0226  0.0267  0.0169  0.3904
 0.0860  0.0994  0.0616  0.5667  0.0124  0.0053  0.0675  0.0060  0.0847  0.0106
 0.3289  0.3157  0.0438  0.0870  0.0193  0.0151  0.0681  0.0508  0.0532  0.0181
 0.0716  0.0949  0.0506  0.6309  0.0099  0.0040  0.0551  0.0043  0.0703  0.0083
 0.2764  0.4694  0.0234  0.0818  0.0125  0.0091  0.0411  0.0456  0.0296  0.0111
 0.2724  0.4807  0.0227  0.0797  0.0122  0.0088  0.0399  0.0443  0.0286  0.0107
 0.0840  0.0429  0.2993  0.0618  0.0411  0.0291  0.1704  0.0479  0.1785  0.0450
 0.0714  0.0348  0.3408  0.0427  0.0429  0.0325  0.1625  0.0560  0.1669  0.0496
 0.4883  0.1819  0.0347  0.0799  0.0201  0.0170  0.0457  0.0717  0.0424  0.0183
[torch.cuda.FloatTensor of size 16x10 (GPU 1)]
, 
 1
 3
 7
 2
 2
 7
 1
 9
 3
 0
 3
 1
 1
 2
 2
 0
[torch.cuda.LongTensor of size 16 (GPU 1)]
, Variable containing:
 1
 6
 7
 2
 2
 7
 2
 4
 3
 0
 3
 1
 0
 2
 2
 0
[torch.cuda.LongTensor of size 16 (GPU 1)]
)
612/960 correct, 0.637%, avg loss: 2.60589632591
(671, 973)
Epoch: 1, Step: 500, Train Loss: 2.91, Val Loss: 0.14, Val acc: 0.690
Param Norm1: 37448.03, grad Norm1: 101.84, Param Norm12: 50.74, grad Norm2: 1.00
(549, 973)
Epoch: 1, Step: 600, Train Loss: 2.65, Val Loss: 0.18, Val acc: 0.564
Param Norm1: 38565.21, grad Norm1: 88.89, Param Norm12: 52.38, grad Norm2: 1.00
(549, 973)
Epoch: 1, Step: 700, Train Loss: 2.47, Val Loss: 0.17, Val acc: 0.564
Param Norm1: 39559.21, grad Norm1: 87.36, Param Norm12: 53.80, grad Norm2: 1.00
(610, 973)
Epoch: 1, Step: 800, Train Loss: 2.37, Val Loss: 0.15, Val acc: 0.627
Param Norm1: 40391.13, grad Norm1: 90.16, Param Norm12: 55.02, grad Norm2: 1.00
(610, 973)
Epoch: 1, Step: 900, Train Loss: 2.33, Val Loss: 0.13, Val acc: 0.627
Param Norm1: 41166.95, grad Norm1: 93.33, Param Norm12: 56.11, grad Norm2: 1.00
Evaluating on training set
Processed 0 batches
(Variable containing:
 0.0319  0.0163  0.0349  0.0097  0.3884  0.1210  0.0268  0.0120  0.0242  0.3348
 0.0321  0.0094  0.0147  0.0014  0.0208  0.0236  0.0208  0.8432  0.0129  0.0211
 0.0174  0.0047  0.8092  0.0096  0.0280  0.0064  0.0441  0.0175  0.0416  0.0215
 0.0661  0.1266  0.0258  0.7132  0.0084  0.0018  0.0181  0.0030  0.0310  0.0059
 0.0386  0.0201  0.0272  0.0101  0.3514  0.1502  0.0262  0.0182  0.0232  0.3347
 0.0949  0.0407  0.2337  0.0436  0.0305  0.0099  0.2128  0.0496  0.2591  0.0252
 0.0370  0.0203  0.0168  0.0069  0.3249  0.1850  0.0225  0.0187  0.0186  0.3493
 0.0864  0.0306  0.1981  0.1049  0.0195  0.0041  0.1899  0.0184  0.3340  0.0141
 0.2053  0.4093  0.0411  0.2419  0.0132  0.0067  0.0281  0.0115  0.0325  0.0104
 0.0290  0.0073  0.0132  0.0011  0.0109  0.0134  0.0175  0.8849  0.0112  0.0114
 0.2211  0.4984  0.0279  0.1687  0.0104  0.0056  0.0231  0.0115  0.0246  0.0085
 0.0388  0.0237  0.0248  0.0109  0.3535  0.1355  0.0320  0.0121  0.0284  0.3403
 0.0779  0.0320  0.2818  0.0432  0.0294  0.0088  0.2049  0.0428  0.2555  0.0237
 0.1981  0.5031  0.0346  0.1573  0.0127  0.0068  0.0310  0.0127  0.0325  0.0112
 0.0849  0.0294  0.2453  0.0678  0.0254  0.0065  0.1985  0.0293  0.2931  0.0197
 0.0291  0.0112  0.6551  0.0144  0.0528  0.0145  0.0760  0.0339  0.0715  0.0415
[torch.cuda.FloatTensor of size 16x10 (GPU 1)]
, 
 4
 7
 2
 3
 4
 8
 9
 8
 1
 7
 1
 4
 2
 1
 8
 2
[torch.cuda.LongTensor of size 16 (GPU 1)]
, Variable containing:
 4
 7
 2
 3
 5
 2
 5
 8
 0
 7
 1
 5
 8
 1
 8
 2
[torch.cuda.LongTensor of size 16 (GPU 1)]
)
Processed 100 batches
Processed 200 batches
Processed 300 batches
Processed 400 batches
5509/7792 correct, 0.707%, avg loss: 2.11049835014
Evaluating on validation set
Processed 0 batches
(Variable containing:
 0.1864  0.6792  0.0213  0.0423  0.0076  0.0061  0.0202  0.0137  0.0162  0.0070
 0.0686  0.0297  0.3380  0.0294  0.0353  0.0117  0.1930  0.0569  0.2080  0.0293
 0.1869  0.6748  0.0213  0.0462  0.0077  0.0060  0.0202  0.0134  0.0165  0.0071
 0.1894  0.6701  0.0217  0.0465  0.0078  0.0061  0.0207  0.0136  0.0169  0.0072
 0.1837  0.6813  0.0211  0.0441  0.0075  0.0059  0.0200  0.0133  0.0162  0.0069
 0.2380  0.5721  0.0208  0.0495  0.0210  0.0188  0.0277  0.0113  0.0203  0.0206
 0.0549  0.0735  0.0245  0.7771  0.0073  0.0013  0.0186  0.0027  0.0349  0.0052
 0.0204  0.0068  0.7691  0.0105  0.0265  0.0065  0.0616  0.0216  0.0567  0.0203
 0.0801  0.0334  0.2884  0.0324  0.0329  0.0109  0.2075  0.0546  0.2323  0.0274
 0.0689  0.0303  0.3389  0.0241  0.0349  0.0118  0.1991  0.0639  0.1990  0.0290
 0.1838  0.6818  0.0211  0.0435  0.0075  0.0060  0.0199  0.0134  0.0162  0.0069
 0.0681  0.0295  0.3426  0.0294  0.0338  0.0109  0.1943  0.0536  0.2099  0.0278
 0.0752  0.0303  0.3342  0.0318  0.0332  0.0104  0.1906  0.0531  0.2142  0.0268
 0.2145  0.1942  0.0412  0.4374  0.0133  0.0055  0.0295  0.0084  0.0454  0.0105
 0.2426  0.1938  0.0672  0.3520  0.0254  0.0098  0.0308  0.0121  0.0472  0.0191
 0.2507  0.5362  0.0294  0.0879  0.0111  0.0072  0.0273  0.0149  0.0253  0.0100
[torch.cuda.FloatTensor of size 16x10 (GPU 1)]
, 
 1
 2
 1
 1
 1
 1
 3
 2
 2
 2
 1
 2
 2
 3
 3
 1
[torch.cuda.LongTensor of size 16 (GPU 1)]
, Variable containing:
 0
 0
 1
 1
 1
 1
 3
 2
 6
 6
 1
 2
 2
 0
 0
 0
[torch.cuda.LongTensor of size 16 (GPU 1)]
)
666/960 correct, 0.694%, avg loss: 2.28658756415
(793, 973)
Epoch: 2, Step: 1000, Train Loss: 2.19, Val Loss: 0.07, Val acc: 0.815
Param Norm1: 41907.53, grad Norm1: 95.85, Param Norm12: 57.14, grad Norm2: 1.00
(671, 973)
Epoch: 2, Step: 1100, Train Loss: 2.10, Val Loss: 0.12, Val acc: 0.690
Param Norm1: 42674.45, grad Norm1: 104.51, Param Norm12: 58.23, grad Norm2: 1.00
(610, 973)
Epoch: 2, Step: 1200, Train Loss: 2.15, Val Loss: 0.12, Val acc: 0.627
Param Norm1: 43486.43, grad Norm1: 94.98, Param Norm12: 59.37, grad Norm2: 1.00
(671, 973)
Epoch: 2, Step: 1300, Train Loss: 2.03, Val Loss: 0.11, Val acc: 0.690
Param Norm1: 44281.53, grad Norm1: 67.80, Param Norm12: 60.46, grad Norm2: 1.00
(732, 973)
Epoch: 2, Step: 1400, Train Loss: 2.14, Val Loss: 0.09, Val acc: 0.752
Param Norm1: 45041.36, grad Norm1: 97.39, Param Norm12: 61.54, grad Norm2: 1.00
Evaluating on training set
Processed 0 batches
(Variable containing:
 0.6327  0.1047  0.0535  0.0326  0.0133  0.0107  0.0367  0.0236  0.0751  0.0171
 0.2093  0.5994  0.0284  0.0679  0.0089  0.0079  0.0195  0.0177  0.0312  0.0097
 0.0845  0.0499  0.2778  0.0180  0.0224  0.0087  0.2343  0.0700  0.2111  0.0233
 0.1472  0.3458  0.0276  0.3899  0.0106  0.0049  0.0145  0.0092  0.0401  0.0102
 0.1170  0.0512  0.2790  0.0185  0.0524  0.0383  0.0859  0.1828  0.1163  0.0586
 0.0231  0.0234  0.0307  0.0073  0.2603  0.2875  0.0173  0.0120  0.0202  0.3182
 0.0796  0.0515  0.3211  0.0197  0.0281  0.0124  0.1827  0.0834  0.1927  0.0290
 0.0219  0.0210  0.0231  0.0067  0.2580  0.2858  0.0158  0.0089  0.0171  0.3418
 0.0245  0.0126  0.0164  0.0017  0.0089  0.0211  0.0140  0.8761  0.0170  0.0076
 0.1844  0.2928  0.1008  0.1259  0.0198  0.0104  0.0743  0.0273  0.1443  0.0198
 0.3140  0.3904  0.0546  0.0777  0.0149  0.0119  0.0338  0.0251  0.0602  0.0175
 0.6409  0.0617  0.0696  0.0294  0.0181  0.0120  0.0418  0.0291  0.0750  0.0227
 0.0808  0.0408  0.1962  0.0242  0.0156  0.0048  0.2767  0.0397  0.3051  0.0161
 0.3512  0.4047  0.0493  0.0520  0.0139  0.0148  0.0272  0.0239  0.0456  0.0173
 0.0872  0.0381  0.4294  0.0413  0.0695  0.0229  0.0619  0.0389  0.1223  0.0884
 0.1514  0.6311  0.0269  0.0566  0.0218  0.0223  0.0233  0.0104  0.0313  0.0249
[torch.cuda.FloatTensor of size 16x10 (GPU 1)]
, 
 0
 1
 2
 3
 2
 9
 2
 9
 7
 1
 1
 0
 8
 1
 2
 1
[torch.cuda.LongTensor of size 16 (GPU 1)]
, Variable containing:
 0
 1
 2
 3
 7
 9
 2
 9
 7
 8
 1
 0
 8
 1
 2
 1
[torch.cuda.LongTensor of size 16 (GPU 1)]
)
Processed 100 batches
Processed 200 batches
Processed 300 batches
Processed 400 batches
5981/7792 correct, 0.768%, avg loss: 1.83576658191
Evaluating on validation set
Processed 0 batches
(Variable containing:
 0.1541  0.6939  0.0246  0.0449  0.0072  0.0080  0.0171  0.0172  0.0252  0.0078
 0.0770  0.0360  0.0337  0.0054  0.0527  0.1564  0.0276  0.5171  0.0314  0.0628
 0.1883  0.6111  0.0318  0.0605  0.0096  0.0090  0.0240  0.0205  0.0349  0.0103
 0.0511  0.0240  0.1695  0.0571  0.0112  0.0022  0.1770  0.0163  0.4807  0.0109
 0.1474  0.7138  0.0229  0.0400  0.0065  0.0075  0.0158  0.0161  0.0232  0.0069
 0.0284  0.0215  0.0586  0.0109  0.2738  0.1693  0.0229  0.0071  0.0258  0.3817
 0.1581  0.1277  0.1934  0.0343  0.0250  0.0127  0.1606  0.0647  0.1987  0.0248
 0.0140  0.0040  0.8852  0.0057  0.0105  0.0020  0.0218  0.0106  0.0327  0.0133
 0.0832  0.0476  0.2442  0.0517  0.0190  0.0055  0.1618  0.0286  0.3390  0.0194
 0.0891  0.0402  0.3535  0.0210  0.0170  0.0043  0.1431  0.0689  0.2443  0.0188
 0.1584  0.6832  0.0245  0.0509  0.0074  0.0076  0.0175  0.0166  0.0261  0.0079
 0.0205  0.0084  0.8158  0.0061  0.0145  0.0035  0.0446  0.0216  0.0482  0.0167
 0.0154  0.0047  0.8744  0.0056  0.0119  0.0024  0.0241  0.0123  0.0343  0.0149
 0.0242  0.0242  0.0293  0.0080  0.2618  0.2734  0.0176  0.0119  0.0205  0.3291
 0.0581  0.0311  0.2297  0.0491  0.0142  0.0033  0.1746  0.0222  0.4036  0.0142
 0.1431  0.7213  0.0227  0.0384  0.0064  0.0075  0.0153  0.0161  0.0225  0.0068
[torch.cuda.FloatTensor of size 16x10 (GPU 1)]
, 
 1
 7
 1
 8
 1
 9
 8
 2
 8
 2
 1
 2
 2
 9
 8
 1
[torch.cuda.LongTensor of size 16 (GPU 1)]
, Variable containing:
 1
 7
 1
 8
 1
 9
 8
 2
 2
 2
 1
 2
 2
 5
 8
 0
[torch.cuda.LongTensor of size 16 (GPU 1)]
)
681/960 correct, 0.709%, avg loss: 2.15521024466
(854, 973)
Epoch: 3, Step: 1500, Train Loss: 1.97, Val Loss: 0.07, Val acc: 0.878
Param Norm1: 45881.25, grad Norm1: 95.95, Param Norm12: 62.75, grad Norm2: 1.00
(793, 973)
Epoch: 3, Step: 1600, Train Loss: 1.94, Val Loss: 0.09, Val acc: 0.815
Param Norm1: 46682.66, grad Norm1: 118.22, Param Norm12: 63.85, grad Norm2: 1.00
(854, 973)
Epoch: 3, Step: 1700, Train Loss: 1.86, Val Loss: 0.09, Val acc: 0.878
Param Norm1: 47488.21, grad Norm1: 86.69, Param Norm12: 64.99, grad Norm2: 1.00
(793, 973)
Epoch: 3, Step: 1800, Train Loss: 1.86, Val Loss: 0.14, Val acc: 0.815
Param Norm1: 48193.53, grad Norm1: 104.27, Param Norm12: 65.93, grad Norm2: 1.00
(732, 973)
Epoch: 3, Step: 1900, Train Loss: 2.06, Val Loss: 0.10, Val acc: 0.752
Param Norm1: 48824.48, grad Norm1: 65.85, Param Norm12: 66.72, grad Norm2: 1.00
Evaluating on training set
Processed 0 batches
(Variable containing:
 0.0319  0.0225  0.0036  0.0043  0.0478  0.7454  0.0100  0.0238  0.0118  0.0989
 0.0200  0.0069  0.8639  0.0044  0.0102  0.0027  0.0221  0.0155  0.0429  0.0115
 0.0626  0.0366  0.1724  0.0089  0.0109  0.0030  0.5048  0.0300  0.1597  0.0111
 0.1860  0.5655  0.0550  0.0570  0.0122  0.0091  0.0362  0.0262  0.0397  0.0130
 0.0920  0.0512  0.0935  0.0661  0.0151  0.0048  0.1028  0.0354  0.5239  0.0151
 0.0713  0.0980  0.0243  0.7170  0.0127  0.0038  0.0097  0.0096  0.0405  0.0132
 0.0415  0.0157  0.7392  0.0095  0.0096  0.0025  0.0620  0.0112  0.0977  0.0111
 0.0925  0.8140  0.0171  0.0252  0.0043  0.0044  0.0133  0.0143  0.0104  0.0045
 0.8223  0.0658  0.0215  0.0153  0.0095  0.0063  0.0246  0.0088  0.0130  0.0129
 0.1150  0.0674  0.0982  0.2742  0.0282  0.0096  0.0393  0.0377  0.3017  0.0287
 0.0136  0.0091  0.0084  0.0008  0.0044  0.0071  0.0133  0.9300  0.0093  0.0040
 0.2209  0.2682  0.0398  0.3461  0.0160  0.0085  0.0182  0.0180  0.0475  0.0167
 0.0862  0.0291  0.1000  0.0267  0.2024  0.1002  0.0400  0.0335  0.0638  0.3180
 0.0580  0.0694  0.0161  0.7943  0.0102  0.0026  0.0056  0.0066  0.0268  0.0105
 0.0762  0.0271  0.1688  0.0625  0.0177  0.0052  0.0558  0.0253  0.5434  0.0180
 0.0395  0.0226  0.0219  0.0034  0.0093  0.0120  0.0274  0.8311  0.0246  0.0082
[torch.cuda.FloatTensor of size 16x10 (GPU 1)]
, 
 5
 2
 6
 1
 8
 3
 2
 1
 0
 8
 7
 3
 9
 3
 8
 7
[torch.cuda.LongTensor of size 16 (GPU 1)]
, Variable containing:
 5
 2
 6
 1
 6
 3
 2
 1
 0
 2
 7
 1
 4
 3
 8
 7
[torch.cuda.LongTensor of size 16 (GPU 1)]
)
Processed 100 batches
Processed 200 batches
Processed 300 batches
Processed 400 batches
6197/7792 correct, 0.795%, avg loss: 1.69441552916
Evaluating on validation set
Processed 0 batches
(Variable containing:
 0.0781  0.8430  0.0137  0.0230  0.0036  0.0039  0.0105  0.0122  0.0083  0.0037
 0.0538  0.0345  0.1813  0.0105  0.0108  0.0029  0.4853  0.0298  0.1804  0.0107
 0.1156  0.0727  0.1321  0.0521  0.0192  0.0070  0.1304  0.0451  0.4068  0.0191
 0.0976  0.8097  0.0164  0.0250  0.0043  0.0046  0.0129  0.0149  0.0100  0.0045
 0.0365  0.0197  0.0221  0.0100  0.1972  0.2356  0.0157  0.0089  0.0272  0.4270
 0.1755  0.0984  0.1402  0.0448  0.0243  0.0106  0.1482  0.0638  0.2692  0.0249
 0.0807  0.8367  0.0152  0.0224  0.0038  0.0042  0.0111  0.0132  0.0089  0.0039
 0.0665  0.0438  0.0862  0.0625  0.0129  0.0039  0.0971  0.0322  0.5819  0.0129
 0.0121  0.0088  0.0094  0.0008  0.0048  0.0081  0.0121  0.9298  0.0098  0.0043
 0.1129  0.7747  0.0191  0.0356  0.0054  0.0052  0.0136  0.0154  0.0123  0.0057
 0.0957  0.7997  0.0281  0.0211  0.0034  0.0025  0.0147  0.0181  0.0128  0.0039
 0.0854  0.8292  0.0153  0.0235  0.0039  0.0042  0.0119  0.0132  0.0092  0.0041
 0.0715  0.0245  0.3632  0.0362  0.0144  0.0042  0.0621  0.0171  0.3911  0.0158
 0.0490  0.0252  0.6494  0.0092  0.0202  0.0073  0.0742  0.0413  0.1028  0.0213
 0.0577  0.0423  0.2558  0.0102  0.0114  0.0032  0.4183  0.0310  0.1589  0.0112
 0.8389  0.0389  0.0222  0.0101  0.0072  0.0034  0.0353  0.0158  0.0191  0.0090
[torch.cuda.FloatTensor of size 16x10 (GPU 1)]
, 
 1
 6
 8
 1
 9
 8
 1
 8
 7
 1
 1
 1
 8
 2
 6
 0
[torch.cuda.LongTensor of size 16 (GPU 1)]
, Variable containing:
 1
 6
 2
 1
 4
 0
 0
 8
 7
 1
 1
 1
 2
 2
 8
 0
[torch.cuda.LongTensor of size 16 (GPU 1)]
)
695/960 correct, 0.724%, avg loss: 2.21024198731
(854, 973)
Epoch: 4, Step: 2000, Train Loss: 1.81, Val Loss: 0.08, Val acc: 0.878
Param Norm1: 49599.26, grad Norm1: 95.82, Param Norm12: 67.80, grad Norm2: 1.00
(915, 973)
Epoch: 4, Step: 2100, Train Loss: 1.65, Val Loss: 0.08, Val acc: 0.940
Param Norm1: 50182.03, grad Norm1: 73.35, Param Norm12: 68.61, grad Norm2: 1.00
(915, 973)
Epoch: 4, Step: 2200, Train Loss: 1.70, Val Loss: 0.10, Val acc: 0.940
Param Norm1: 50745.41, grad Norm1: 89.96, Param Norm12: 69.43, grad Norm2: 1.00
(793, 973)
Epoch: 4, Step: 2300, Train Loss: 1.84, Val Loss: 0.09, Val acc: 0.815
Param Norm1: 51324.12, grad Norm1: 90.56, Param Norm12: 70.20, grad Norm2: 1.00
(732, 973)
Epoch: 4, Step: 2400, Train Loss: 1.78, Val Loss: 0.10, Val acc: 0.752
Param Norm1: 51947.60, grad Norm1: 130.59, Param Norm12: 71.03, grad Norm2: 1.00
Evaluating on training set
Processed 0 batches
(Variable containing:
 0.0477  0.0220  0.3961  0.0197  0.0185  0.0048  0.0674  0.0506  0.3566  0.0166
 0.0053  0.0047  0.0052  0.0005  0.0043  0.0031  0.0044  0.9653  0.0049  0.0023
 0.6563  0.0577  0.0672  0.0180  0.0179  0.0065  0.0474  0.0610  0.0519  0.0161
 0.0062  0.0049  0.0068  0.0006  0.0056  0.0037  0.0053  0.9581  0.0060  0.0029
 0.7101  0.1362  0.0377  0.0250  0.0107  0.0056  0.0202  0.0228  0.0215  0.0102
 0.1221  0.0291  0.1815  0.0264  0.0197  0.0057  0.0869  0.0652  0.4431  0.0202
 0.0956  0.0758  0.2571  0.0273  0.0646  0.0301  0.0939  0.1516  0.1486  0.0554
 0.0714  0.0306  0.4425  0.0117  0.0200  0.0053  0.1552  0.0547  0.1904  0.0181
 0.0447  0.0189  0.6276  0.0115  0.0186  0.0044  0.0610  0.0369  0.1599  0.0167
 0.2551  0.0565  0.1537  0.0497  0.0250  0.0070  0.0818  0.0460  0.3030  0.0222
 0.1099  0.7703  0.0314  0.0323  0.0067  0.0047  0.0100  0.0153  0.0135  0.0059
 0.0320  0.0466  0.0161  0.8512  0.0085  0.0014  0.0038  0.0058  0.0262  0.0084
 0.0199  0.0148  0.0430  0.0296  0.4632  0.0519  0.0186  0.0059  0.0385  0.3146
 0.2419  0.6081  0.0336  0.0423  0.0083  0.0065  0.0152  0.0200  0.0164  0.0075
 0.1487  0.2750  0.0428  0.4246  0.0144  0.0058  0.0135  0.0151  0.0466  0.0134
 0.1190  0.2374  0.0279  0.5396  0.0115  0.0039  0.0083  0.0123  0.0303  0.0098
[torch.cuda.FloatTensor of size 16x10 (GPU 1)]
, 
 2
 7
 0
 7
 0
 8
 2
 2
 2
 8
 1
 3
 4
 1
 3
 3
[torch.cuda.LongTensor of size 16 (GPU 1)]
, Variable containing:
 8
 7
 0
 7
 0
 8
 8
 8
 2
 0
 1
 3
 9
 1
 1
 0
[torch.cuda.LongTensor of size 16 (GPU 1)]
)
Processed 100 batches
Processed 200 batches
Processed 300 batches
Processed 400 batches
6152/7792 correct, 0.790%, avg loss: 1.61835910891
Evaluating on validation set
Processed 0 batches
(Variable containing:
 0.0230  0.0124  0.0196  0.0099  0.4253  0.1651  0.0178  0.0102  0.0220  0.2946
 0.0187  0.0083  0.8394  0.0056  0.0137  0.0029  0.0291  0.0181  0.0509  0.0132
 0.0356  0.0145  0.7026  0.0101  0.0214  0.0052  0.0558  0.0330  0.0998  0.0219
 0.1038  0.1626  0.0329  0.6195  0.0139  0.0043  0.0086  0.0100  0.0323  0.0121
 0.1920  0.5792  0.0377  0.0981  0.0108  0.0074  0.0195  0.0194  0.0264  0.0094
 0.0684  0.0330  0.2686  0.0323  0.0235  0.0071  0.0808  0.0587  0.4062  0.0214
 0.1002  0.8043  0.0185  0.0333  0.0049  0.0044  0.0085  0.0114  0.0102  0.0043
 0.1466  0.6618  0.0473  0.0505  0.0125  0.0124  0.0183  0.0180  0.0225  0.0101
 0.0954  0.0882  0.1928  0.0402  0.1046  0.0528  0.0916  0.1120  0.1306  0.0916
 0.0338  0.0111  0.1070  0.0267  0.0105  0.0022  0.0683  0.0303  0.7000  0.0101
 0.0400  0.0144  0.3465  0.0248  0.0158  0.0037  0.0647  0.0330  0.4413  0.0156
 0.1513  0.0319  0.4162  0.0389  0.0296  0.0075  0.0494  0.0294  0.2219  0.0240
 0.1130  0.7891  0.0219  0.0270  0.0052  0.0053  0.0095  0.0148  0.0098  0.0045
 0.1126  0.7841  0.0206  0.0311  0.0066  0.0058  0.0107  0.0118  0.0111  0.0057
 0.1416  0.7360  0.0221  0.0457  0.0063  0.0055  0.0101  0.0143  0.0127  0.0056
 0.0611  0.0235  0.2239  0.0139  0.0132  0.0029  0.3057  0.0378  0.3044  0.0136
[torch.cuda.FloatTensor of size 16x10 (GPU 1)]
, 
 4
 2
 2
 3
 1
 8
 1
 1
 2
 8
 8
 2
 1
 1
 1
 6
[torch.cuda.LongTensor of size 16 (GPU 1)]
, Variable containing:
 5
 2
 2
 3
 1
 0
 1
 1
 2
 8
 2
 2
 1
 1
 1
 6
[torch.cuda.LongTensor of size 16 (GPU 1)]
)
682/960 correct, 0.710%, avg loss: 2.29290131529
(915, 973)
Epoch: 5, Step: 2500, Train Loss: 1.70, Val Loss: 0.07, Val acc: 0.940
Param Norm1: 52495.20, grad Norm1: 92.63, Param Norm12: 71.83, grad Norm2: 1.00
(915, 973)
Epoch: 5, Step: 2600, Train Loss: 1.59, Val Loss: 0.06, Val acc: 0.940
Param Norm1: 53086.32, grad Norm1: 99.12, Param Norm12: 72.65, grad Norm2: 1.00
(854, 973)
Epoch: 5, Step: 2700, Train Loss: 1.67, Val Loss: 0.05, Val acc: 0.878
Param Norm1: 53538.92, grad Norm1: 83.00, Param Norm12: 73.34, grad Norm2: 1.00
(610, 973)
Epoch: 5, Step: 2800, Train Loss: 1.69, Val Loss: 0.12, Val acc: 0.627
Param Norm1: 54025.79, grad Norm1: 84.48, Param Norm12: 73.99, grad Norm2: 1.00
(915, 973)
Epoch: 5, Step: 2900, Train Loss: 1.64, Val Loss: 0.07, Val acc: 0.940
Param Norm1: 54583.65, grad Norm1: 89.11, Param Norm12: 74.69, grad Norm2: 1.00
Evaluating on training set
Processed 0 batches
(Variable containing:
 0.1078  0.8030  0.0182  0.0278  0.0049  0.0047  0.0084  0.0106  0.0106  0.0041
 0.1961  0.5672  0.0668  0.0477  0.0119  0.0093  0.0275  0.0237  0.0389  0.0110
 0.3404  0.4369  0.0322  0.1005  0.0115  0.0075  0.0193  0.0161  0.0254  0.0101
 0.5961  0.1588  0.0445  0.0260  0.0278  0.0394  0.0224  0.0245  0.0238  0.0366
 0.0669  0.0857  0.0298  0.7436  0.0117  0.0035  0.0078  0.0074  0.0313  0.0122
 0.0975  0.0323  0.5872  0.0213  0.0465  0.0268  0.0297  0.0280  0.0736  0.0571
 0.8298  0.0377  0.0369  0.0129  0.0082  0.0033  0.0248  0.0132  0.0236  0.0095
 0.2401  0.2483  0.0888  0.2194  0.0203  0.0098  0.0420  0.0256  0.0851  0.0207
 0.0912  0.0284  0.1619  0.0501  0.0722  0.0306  0.1200  0.1126  0.2254  0.1078
 0.4044  0.4222  0.0395  0.0438  0.0099  0.0068  0.0226  0.0147  0.0266  0.0095
 0.0779  0.0159  0.5502  0.0127  0.0615  0.0408  0.0310  0.0571  0.0684  0.0846
 0.0890  0.8303  0.0185  0.0228  0.0043  0.0042  0.0079  0.0097  0.0098  0.0036
 0.1135  0.7833  0.0227  0.0310  0.0057  0.0051  0.0089  0.0123  0.0128  0.0048
 0.1436  0.7045  0.0397  0.0363  0.0077  0.0062  0.0178  0.0145  0.0228  0.0070
 0.0967  0.8121  0.0213  0.0267  0.0048  0.0042  0.0092  0.0096  0.0114  0.0039
 0.0695  0.0407  0.4015  0.0230  0.0255  0.0121  0.0960  0.0836  0.2192  0.0289
[torch.cuda.FloatTensor of size 16x10 (GPU 1)]
, 
 1
 1
 1
 0
 3
 2
 0
 1
 8
 1
 2
 1
 1
 1
 1
 2
[torch.cuda.LongTensor of size 16 (GPU 1)]
, Variable containing:
 1
 0
 0
 0
 3
 0
 0
 0
 6
 0
 2
 1
 1
 1
 1
 2
[torch.cuda.LongTensor of size 16 (GPU 1)]
)
Processed 100 batches
Processed 200 batches
Processed 300 batches
Processed 400 batches
6421/7792 correct, 0.824%, avg loss: 1.44440165425
Evaluating on validation set
Processed 0 batches
(Variable containing:
 0.1337  0.0251  0.4804  0.0282  0.0213  0.0090  0.0612  0.0255  0.1876  0.0280
 0.0931  0.0673  0.2785  0.0315  0.0403  0.0234  0.0934  0.1411  0.1881  0.0434
 0.1227  0.7760  0.0230  0.0284  0.0055  0.0049  0.0110  0.0110  0.0129  0.0046
 0.0144  0.0134  0.0070  0.0015  0.0132  0.0116  0.0126  0.9043  0.0111  0.0109
 0.0988  0.1429  0.0206  0.6699  0.0117  0.0041  0.0078  0.0083  0.0250  0.0110
 0.0132  0.0040  0.9030  0.0060  0.0060  0.0022  0.0141  0.0058  0.0371  0.0087
 0.2408  0.6132  0.0305  0.0422  0.0082  0.0065  0.0168  0.0148  0.0198  0.0072
 0.1417  0.7292  0.0387  0.0255  0.0050  0.0038  0.0149  0.0144  0.0224  0.0043
 0.1436  0.7142  0.0327  0.0358  0.0078  0.0071  0.0149  0.0169  0.0202  0.0068
 0.0325  0.0522  0.0096  0.8656  0.0068  0.0017  0.0035  0.0042  0.0164  0.0075
 0.1895  0.5503  0.0439  0.1111  0.0122  0.0080  0.0226  0.0173  0.0341  0.0110
 0.0562  0.0295  0.4053  0.0125  0.0129  0.0048  0.2561  0.0291  0.1776  0.0160
 0.0109  0.0100  0.0074  0.0011  0.0059  0.0051  0.0094  0.9362  0.0094  0.0046
 0.2030  0.6492  0.0321  0.0413  0.0079  0.0061  0.0181  0.0143  0.0210  0.0070
 0.0320  0.0089  0.8025  0.0052  0.0128  0.0053  0.0470  0.0189  0.0500  0.0175
 0.2387  0.0592  0.2851  0.0278  0.0182  0.0090  0.0944  0.0247  0.2172  0.0257
[torch.cuda.FloatTensor of size 16x10 (GPU 1)]
, 
 2
 2
 1
 7
 3
 2
 1
 1
 1
 3
 1
 2
 7
 1
 2
 2
[torch.cuda.LongTensor of size 16 (GPU 1)]
, Variable containing:
 2
 2
 0
 7
 3
 2
 1
 1
 1
 3
 1
 2
 7
 1
 2
 2
[torch.cuda.LongTensor of size 16 (GPU 1)]
)
693/960 correct, 0.722%, avg loss: 2.23530276219
(915, 973)
Epoch: 6, Step: 3000, Train Loss: 1.57, Val Loss: 0.07, Val acc: 0.940
Param Norm1: 55284.23, grad Norm1: 92.32, Param Norm12: 75.71, grad Norm2: 1.00
(915, 973)
Epoch: 6, Step: 3100, Train Loss: 1.49, Val Loss: 0.06, Val acc: 0.940
Param Norm1: 55692.30, grad Norm1: 126.33, Param Norm12: 76.35, grad Norm2: 1.00
(915, 973)
Epoch: 6, Step: 3200, Train Loss: 1.56, Val Loss: 0.05, Val acc: 0.940
Param Norm1: 56122.45, grad Norm1: 130.64, Param Norm12: 76.96, grad Norm2: 1.00
(793, 973)
Epoch: 6, Step: 3300, Train Loss: 1.58, Val Loss: 0.09, Val acc: 0.815
Param Norm1: 56823.75, grad Norm1: 103.84, Param Norm12: 77.94, grad Norm2: 1.00
(854, 973)
Epoch: 6, Step: 3400, Train Loss: 1.51, Val Loss: 0.08, Val acc: 0.878
Param Norm1: 57299.78, grad Norm1: 101.17, Param Norm12: 78.57, grad Norm2: 1.00
Evaluating on training set
Processed 0 batches
(Variable containing:
 0.1058  0.0858  0.2422  0.0273  0.0210  0.0106  0.1605  0.0862  0.2385  0.0222
 0.0897  0.0851  0.2059  0.0357  0.0211  0.0097  0.1439  0.0758  0.3119  0.0212
 0.0042  0.0042  0.0025  0.0006  0.0024  0.0025  0.0043  0.9714  0.0051  0.0026
 0.0138  0.0045  0.8870  0.0077  0.0116  0.0026  0.0270  0.0058  0.0283  0.0118
 0.0561  0.0521  0.0813  0.0469  0.0109  0.0033  0.0772  0.0264  0.6349  0.0108
 0.0047  0.0059  0.0046  0.0008  0.0033  0.0031  0.0053  0.9619  0.0071  0.0034
 0.0090  0.0087  0.0023  0.0017  0.0173  0.9187  0.0060  0.0075  0.0067  0.0221
 0.0564  0.8591  0.0139  0.0271  0.0046  0.0052  0.0081  0.0099  0.0113  0.0044
 0.0097  0.0166  0.0049  0.9427  0.0042  0.0007  0.0025  0.0019  0.0125  0.0042
 0.0554  0.0383  0.1954  0.0078  0.0089  0.0026  0.5271  0.0190  0.1364  0.0091
 0.0873  0.6883  0.0213  0.1391  0.0086  0.0063  0.0110  0.0116  0.0179  0.0086
 0.0550  0.8632  0.0132  0.0260  0.0045  0.0053  0.0077  0.0099  0.0109  0.0043
 0.0573  0.8549  0.0139  0.0295  0.0048  0.0052  0.0083  0.0099  0.0116  0.0045
 0.0039  0.0044  0.0031  0.0005  0.0022  0.0022  0.0043  0.9718  0.0052  0.0024
 0.0512  0.7799  0.0275  0.0669  0.0063  0.0096  0.0177  0.0078  0.0250  0.0081
 0.0916  0.0791  0.2698  0.0310  0.0314  0.0179  0.1077  0.1338  0.2055  0.0324
[torch.cuda.FloatTensor of size 16x10 (GPU 1)]
, 
 2
 8
 7
 2
 8
 7
 5
 1
 3
 6
 1
 1
 1
 7
 1
 2
[torch.cuda.LongTensor of size 16 (GPU 1)]
, Variable containing:
 2
 2
 7
 2
 8
 7
 5
 1
 3
 6
 1
 1
 1
 7
 1
 2
[torch.cuda.LongTensor of size 16 (GPU 1)]
)
Processed 100 batches
Processed 200 batches
Processed 300 batches
Processed 400 batches
6513/7792 correct, 0.836%, avg loss: 1.40106667927
Evaluating on validation set
Processed 0 batches
(Variable containing:
 0.0544  0.0143  0.2527  0.0067  0.0097  0.0030  0.4813  0.0208  0.1445  0.0126
 0.0408  0.0377  0.0793  0.0283  0.0078  0.0022  0.0973  0.0232  0.6757  0.0078
 0.0766  0.8199  0.0184  0.0340  0.0053  0.0051  0.0108  0.0104  0.0143  0.0052
 0.0242  0.0186  0.0023  0.0026  0.0111  0.8704  0.0129  0.0187  0.0105  0.0288
 0.0564  0.8624  0.0133  0.0267  0.0043  0.0047  0.0076  0.0096  0.0108  0.0042
 0.0179  0.0295  0.0078  0.9112  0.0050  0.0011  0.0035  0.0027  0.0161  0.0052
 0.0950  0.7852  0.0232  0.0332  0.0056  0.0047  0.0169  0.0103  0.0202  0.0057
 0.0737  0.0417  0.2298  0.0350  0.0165  0.0051  0.1112  0.0298  0.4395  0.0178
 0.0034  0.0042  0.0024  0.0005  0.0017  0.0018  0.0034  0.9761  0.0044  0.0020
 0.0286  0.0646  0.0074  0.8662  0.0055  0.0014  0.0039  0.0035  0.0140  0.0048
 0.0335  0.0348  0.0485  0.0194  0.0053  0.0018  0.0968  0.0200  0.7338  0.0060
 0.0585  0.8564  0.0146  0.0273  0.0045  0.0048  0.0080  0.0099  0.0115  0.0044
 0.0425  0.0470  0.0319  0.1957  0.0099  0.0023  0.0354  0.0217  0.6034  0.0102
 0.0038  0.0042  0.0039  0.0006  0.0020  0.0019  0.0047  0.9706  0.0063  0.0020
 0.0097  0.0035  0.9154  0.0061  0.0054  0.0012  0.0258  0.0030  0.0244  0.0053
 0.0440  0.0304  0.1075  0.0145  0.0069  0.0017  0.4137  0.0144  0.3603  0.0065
[torch.cuda.FloatTensor of size 16x10 (GPU 1)]
, 
 6
 8
 1
 5
 1
 3
 1
 8
 7
 3
 8
 1
 8
 7
 2
 6
[torch.cuda.LongTensor of size 16 (GPU 1)]
, Variable containing:
 2
 8
 0
 5
 1
 3
 1
 1
 7
 3
 8
 1
 8
 7
 2
 6
[torch.cuda.LongTensor of size 16 (GPU 1)]
)
699/960 correct, 0.728%, avg loss: 2.30066724171
(976, 973)
Epoch: 7, Step: 3500, Train Loss: 1.37, Val Loss: 0.03, Val acc: 1.003
Param Norm1: 57833.91, grad Norm1: 95.58, Param Norm12: 79.29, grad Norm2: 1.00
(793, 973)
Epoch: 7, Step: 3600, Train Loss: 1.41, Val Loss: 0.07, Val acc: 0.815
Param Norm1: 58419.80, grad Norm1: 108.72, Param Norm12: 80.12, grad Norm2: 1.00
(854, 973)
Epoch: 7, Step: 3700, Train Loss: 1.49, Val Loss: 0.06, Val acc: 0.878
Param Norm1: 59153.67, grad Norm1: 90.33, Param Norm12: 81.05, grad Norm2: 1.00
(854, 973)
Epoch: 7, Step: 3800, Train Loss: 1.51, Val Loss: 0.07, Val acc: 0.878
Param Norm1: 59444.80, grad Norm1: 77.80, Param Norm12: 81.53, grad Norm2: 1.00
Evaluating on training set
Processed 0 batches
(Variable containing:
 0.0543  0.8815  0.0143  0.0181  0.0036  0.0033  0.0079  0.0067  0.0075  0.0027
 0.0581  0.0239  0.4912  0.0089  0.0110  0.0026  0.2912  0.0175  0.0873  0.0083
 0.0751  0.0351  0.3195  0.0162  0.0279  0.0173  0.1260  0.1679  0.1884  0.0266
 0.0106  0.0028  0.9334  0.0027  0.0055  0.0011  0.0206  0.0049  0.0149  0.0034
 0.3276  0.4869  0.0416  0.0600  0.0106  0.0063  0.0253  0.0113  0.0220  0.0084
 0.0901  0.0401  0.3158  0.0117  0.0156  0.0054  0.3650  0.0413  0.1011  0.0140
 0.8647  0.0595  0.0124  0.0087  0.0046  0.0093  0.0169  0.0049  0.0151  0.0038
 0.0887  0.8233  0.0190  0.0245  0.0052  0.0046  0.0115  0.0086  0.0105  0.0040
 0.0048  0.0009  0.9652  0.0028  0.0031  0.0004  0.0062  0.0041  0.0107  0.0019
 0.2215  0.5483  0.0390  0.1134  0.0110  0.0061  0.0185  0.0100  0.0235  0.0088
 0.0614  0.0256  0.4942  0.0080  0.0129  0.0035  0.2789  0.0289  0.0766  0.0100
 0.0054  0.0017  0.9617  0.0029  0.0040  0.0006  0.0056  0.0035  0.0122  0.0023
 0.0673  0.0213  0.3311  0.0063  0.0085  0.0016  0.4640  0.0080  0.0853  0.0065
 0.0045  0.0009  0.9744  0.0019  0.0034  0.0005  0.0048  0.0022  0.0055  0.0019
 0.0519  0.0199  0.5908  0.0094  0.0102  0.0027  0.1675  0.0221  0.1177  0.0079
 0.0668  0.0228  0.2392  0.0066  0.0106  0.0025  0.5335  0.0172  0.0918  0.0091
[torch.cuda.FloatTensor of size 16x10 (GPU 1)]
, 
 1
 2
 2
 2
 1
 6
 0
 1
 2
 1
 2
 2
 6
 2
 2
 6
[torch.cuda.LongTensor of size 16 (GPU 1)]
, Variable containing:
 1
 2
 8
 2
 1
 6
 0
 1
 2
 1
 6
 2
 6
 2
 2
 6
[torch.cuda.LongTensor of size 16 (GPU 1)]
)
Processed 100 batches
Processed 200 batches
Processed 300 batches
Processed 400 batches
6660/7792 correct, 0.855%, avg loss: 1.26816466405
Evaluating on validation set
Processed 0 batches
(Variable containing:
 0.4416  0.2237  0.0928  0.0339  0.0153  0.0088  0.0761  0.0275  0.0653  0.0149
 0.1186  0.0743  0.3400  0.0319  0.0304  0.0150  0.1152  0.1141  0.1335  0.0269
 0.3777  0.2520  0.0322  0.2303  0.0126  0.0059  0.0284  0.0112  0.0387  0.0109
 0.0179  0.0052  0.8292  0.0080  0.0279  0.0060  0.0440  0.0108  0.0276  0.0233
 0.0654  0.0231  0.5284  0.0209  0.1173  0.0340  0.0376  0.0444  0.0492  0.0799
 0.0087  0.0028  0.9432  0.0033  0.0036  0.0006  0.0138  0.0038  0.0180  0.0022
 0.0132  0.0043  0.9293  0.0034  0.0082  0.0017  0.0169  0.0061  0.0122  0.0047
 0.0473  0.0062  0.5274  0.0057  0.0123  0.0031  0.2745  0.0246  0.0868  0.0122
 0.9002  0.0255  0.0263  0.0056  0.0046  0.0015  0.0148  0.0044  0.0126  0.0044
 0.0135  0.0151  0.0127  0.0009  0.0050  0.0032  0.0130  0.9222  0.0103  0.0042
 0.0665  0.0701  0.0113  0.8124  0.0067  0.0016  0.0049  0.0046  0.0162  0.0056
 0.0754  0.8461  0.0173  0.0217  0.0046  0.0041  0.0105  0.0075  0.0093  0.0035
 0.1467  0.7140  0.0239  0.0545  0.0076  0.0057  0.0158  0.0099  0.0160  0.0058
 0.0083  0.0024  0.9374  0.0042  0.0040  0.0008  0.0102  0.0036  0.0263  0.0028
 0.1631  0.5981  0.0268  0.1449  0.0098  0.0060  0.0142  0.0102  0.0195  0.0074
 0.0109  0.0030  0.8568  0.0088  0.0087  0.0020  0.0196  0.0142  0.0695  0.0066
[torch.cuda.FloatTensor of size 16x10 (GPU 1)]
, 
 0
 2
 0
 2
 2
 2
 2
 2
 0
 7
 3
 1
 1
 2
 1
 2
[torch.cuda.LongTensor of size 16 (GPU 1)]
, Variable containing:
 8
 2
 1
 2
 8
 2
 2
 2
 1
 7
 3
 1
 1
 2
 3
 2
[torch.cuda.LongTensor of size 16 (GPU 1)]
)
688/960 correct, 0.717%, avg loss: 2.55516422987
(854, 973)
Epoch: 8, Step: 3900, Train Loss: 1.46, Val Loss: 0.04, Val acc: 0.878
Param Norm1: 59978.05, grad Norm1: 97.45, Param Norm12: 82.28, grad Norm2: 1.00
(915, 973)
Epoch: 8, Step: 4000, Train Loss: 1.36, Val Loss: 0.08, Val acc: 0.940
Param Norm1: 60486.10, grad Norm1: 81.79, Param Norm12: 82.98, grad Norm2: 1.00
(854, 973)
Epoch: 8, Step: 4100, Train Loss: 1.33, Val Loss: 0.09, Val acc: 0.878
Param Norm1: 60894.55, grad Norm1: 90.11, Param Norm12: 83.59, grad Norm2: 1.00
(671, 973)
Epoch: 8, Step: 4200, Train Loss: 1.36, Val Loss: 0.16, Val acc: 0.690
Param Norm1: 61654.81, grad Norm1: 98.37, Param Norm12: 84.63, grad Norm2: 1.00
(915, 973)
Epoch: 8, Step: 4300, Train Loss: 1.40, Val Loss: 0.07, Val acc: 0.940
Param Norm1: 62169.14, grad Norm1: 111.44, Param Norm12: 85.33, grad Norm2: 1.00
Evaluating on training set
Processed 0 batches
(Variable containing:
 0.0316  0.9239  0.0065  0.0109  0.0025  0.0035  0.0057  0.0056  0.0079  0.0019
 0.1503  0.7521  0.0163  0.0250  0.0058  0.0064  0.0117  0.0103  0.0162  0.0060
 0.0494  0.8095  0.0259  0.0384  0.0085  0.0074  0.0150  0.0138  0.0260  0.0062
 0.0133  0.0082  0.0124  0.0162  0.0034  0.0011  0.0095  0.0094  0.9235  0.0031
 0.0045  0.0009  0.9714  0.0019  0.0024  0.0005  0.0059  0.0018  0.0088  0.0020
 0.0044  0.0009  0.9700  0.0017  0.0021  0.0004  0.0071  0.0018  0.0098  0.0017
 0.0189  0.0125  0.0212  0.0167  0.1082  0.5020  0.0245  0.0061  0.0315  0.2583
 0.0254  0.9348  0.0056  0.0100  0.0023  0.0033  0.0046  0.0053  0.0070  0.0017
 0.0133  0.0102  0.0196  0.0311  0.1902  0.1050  0.0144  0.0054  0.0281  0.5828
 0.0035  0.0009  0.9745  0.0013  0.0018  0.0003  0.0077  0.0011  0.0073  0.0014
 0.2607  0.2434  0.0780  0.0937  0.0186  0.0106  0.0729  0.0305  0.1759  0.0158
 0.0142  0.0178  0.0070  0.9311  0.0058  0.0010  0.0025  0.0026  0.0132  0.0048
 0.0118  0.0170  0.0050  0.9418  0.0053  0.0008  0.0017  0.0019  0.0107  0.0040
 0.0372  0.9116  0.0065  0.0123  0.0029  0.0046  0.0060  0.0074  0.0091  0.0025
 0.0643  0.8558  0.0127  0.0182  0.0041  0.0049  0.0121  0.0084  0.0162  0.0033
 0.0035  0.0070  0.0030  0.0003  0.0013  0.0033  0.0044  0.9685  0.0059  0.0027
[torch.cuda.FloatTensor of size 16x10 (GPU 1)]
, 
 1
 1
 1
 8
 2
 2
 5
 1
 9
 2
 0
 3
 3
 1
 1
 7
[torch.cuda.LongTensor of size 16 (GPU 1)]
, Variable containing:
 1
 1
 1
 8
 2
 2
 9
 1
 9
 2
 0
 3
 3
 1
 1
 7
[torch.cuda.LongTensor of size 16 (GPU 1)]
)
Processed 100 batches
Processed 200 batches
Processed 300 batches
Processed 400 batches
6785/7792 correct, 0.871%, avg loss: 1.1375602529
Evaluating on validation set
Processed 0 batches
(Variable containing:
 0.8127  0.1123  0.0076  0.0190  0.0060  0.0064  0.0087  0.0065  0.0120  0.0088
 0.0138  0.0141  0.0185  0.0143  0.1070  0.4646  0.0220  0.0059  0.0294  0.3103
 0.0032  0.0041  0.0052  0.0004  0.0015  0.0037  0.0043  0.9687  0.0063  0.0026
 0.0433  0.0146  0.6507  0.0067  0.0098  0.0031  0.1649  0.0133  0.0848  0.0087
 0.0263  0.0162  0.0473  0.0107  0.0056  0.0020  0.0513  0.0224  0.8131  0.0051
 0.0609  0.1770  0.0103  0.7015  0.0092  0.0033  0.0055  0.0064  0.0195  0.0064
 0.0302  0.9261  0.0059  0.0101  0.0025  0.0039  0.0053  0.0063  0.0079  0.0020
 0.0168  0.0493  0.0054  0.9037  0.0062  0.0012  0.0016  0.0025  0.0090  0.0042
 0.0258  0.0102  0.7407  0.0099  0.0093  0.0030  0.0449  0.0125  0.1354  0.0083
 0.0427  0.0183  0.4175  0.0057  0.0086  0.0029  0.2989  0.0209  0.1757  0.0089
 0.0095  0.0140  0.0081  0.9378  0.0069  0.0011  0.0020  0.0030  0.0122  0.0055
 0.0060  0.0114  0.0059  0.0006  0.0026  0.0065  0.0057  0.9468  0.0101  0.0045
 0.9363  0.0151  0.0114  0.0045  0.0022  0.0012  0.0087  0.0041  0.0133  0.0032
 0.0312  0.9170  0.0034  0.0163  0.0049  0.0106  0.0045  0.0032  0.0054  0.0037
 0.0494  0.0206  0.1895  0.0055  0.0067  0.0020  0.5557  0.0181  0.1461  0.0064
 0.0909  0.7823  0.0192  0.0207  0.0081  0.0078  0.0245  0.0106  0.0294  0.0066
[torch.cuda.FloatTensor of size 16x10 (GPU 1)]
, 
 0
 5
 7
 2
 8
 3
 1
 3
 2
 2
 3
 7
 0
 1
 6
 1
[torch.cuda.LongTensor of size 16 (GPU 1)]
, Variable containing:
 0
 9
 7
 8
 8
 3
 1
 3
 8
 2
 3
 7
 0
 0
 6
 0
[torch.cuda.LongTensor of size 16 (GPU 1)]
)
689/960 correct, 0.718%, avg loss: 2.70472034315
(915, 973)
Epoch: 9, Step: 4400, Train Loss: 1.24, Val Loss: 0.03, Val acc: 0.940
Param Norm1: 62596.40, grad Norm1: 85.12, Param Norm12: 85.97, grad Norm2: 1.00
(854, 973)
Epoch: 9, Step: 4500, Train Loss: 1.21, Val Loss: 0.05, Val acc: 0.878
Param Norm1: 63261.53, grad Norm1: 79.05, Param Norm12: 86.85, grad Norm2: 1.00
(976, 973)
Epoch: 9, Step: 4600, Train Loss: 1.33, Val Loss: 0.02, Val acc: 1.003
Param Norm1: 63802.65, grad Norm1: 112.32, Param Norm12: 87.63, grad Norm2: 1.00
(915, 973)
Epoch: 9, Step: 4700, Train Loss: 1.25, Val Loss: 0.05, Val acc: 0.940
Param Norm1: 64328.54, grad Norm1: 92.76, Param Norm12: 88.42, grad Norm2: 1.00
(976, 973)
Epoch: 9, Step: 4800, Train Loss: 1.21, Val Loss: 0.03, Val acc: 1.003
Param Norm1: 64787.62, grad Norm1: 109.50, Param Norm12: 89.07, grad Norm2: 1.00
Evaluating on training set
Processed 0 batches
(Variable containing:
 0.0178  0.0346  0.0068  0.9100  0.0040  0.0008  0.0024  0.0014  0.0128  0.0095
 0.1155  0.6005  0.0148  0.2095  0.0101  0.0062  0.0107  0.0076  0.0190  0.0061
 0.0454  0.8726  0.0094  0.0397  0.0048  0.0040  0.0071  0.0046  0.0097  0.0027
 0.0255  0.9352  0.0075  0.0086  0.0022  0.0027  0.0071  0.0038  0.0063  0.0011
 0.0432  0.0423  0.0713  0.0401  0.1759  0.1146  0.0402  0.0268  0.0434  0.4020
 0.0031  0.0042  0.0051  0.0004  0.0013  0.0022  0.0069  0.9689  0.0051  0.0029
 0.0473  0.8937  0.0107  0.0119  0.0032  0.0037  0.0108  0.0061  0.0107  0.0018
 0.0184  0.0327  0.0057  0.9205  0.0055  0.0011  0.0020  0.0015  0.0088  0.0037
 0.0166  0.9514  0.0061  0.0072  0.0018  0.0025  0.0048  0.0036  0.0050  0.0009
 0.1679  0.7371  0.0163  0.0261  0.0079  0.0065  0.0129  0.0073  0.0126  0.0054
 0.0103  0.0101  0.0292  0.0062  0.0039  0.0011  0.0297  0.0094  0.8946  0.0056
 0.0050  0.0118  0.0055  0.0005  0.0019  0.0037  0.0076  0.9538  0.0068  0.0034
 0.0114  0.0090  0.0397  0.0068  0.0053  0.0019  0.0193  0.0168  0.8833  0.0067
 0.0360  0.9006  0.0107  0.0136  0.0043  0.0052  0.0090  0.0066  0.0111  0.0030
 0.5821  0.1197  0.0990  0.0159  0.0108  0.0045  0.0730  0.0207  0.0665  0.0079
 0.0693  0.8022  0.0144  0.0679  0.0069  0.0049  0.0100  0.0057  0.0150  0.0037
[torch.cuda.FloatTensor of size 16x10 (GPU 1)]
, 
 3
 1
 1
 1
 9
 7
 1
 3
 1
 1
 8
 7
 8
 1
 0
 1
[torch.cuda.LongTensor of size 16 (GPU 1)]
, Variable containing:
 3
 1
 1
 1
 9
 7
 1
 3
 1
 1
 8
 7
 8
 1
 0
 1
[torch.cuda.LongTensor of size 16 (GPU 1)]
)
Processed 100 batches
Processed 200 batches
Processed 300 batches
Processed 400 batches
6769/7792 correct, 0.869%, avg loss: 1.14002349352
Evaluating on validation set
Processed 0 batches
(Variable containing:
 0.9070  0.0310  0.0171  0.0063  0.0033  0.0007  0.0135  0.0015  0.0172  0.0024
 0.2492  0.6062  0.0220  0.0442  0.0112  0.0084  0.0172  0.0097  0.0246  0.0074
 0.0278  0.0174  0.1500  0.0045  0.0056  0.0014  0.6966  0.0083  0.0822  0.0062
 0.1066  0.8056  0.0125  0.0140  0.0043  0.0085  0.0137  0.0151  0.0165  0.0031
 0.1025  0.1140  0.1487  0.0677  0.0777  0.0397  0.1197  0.0883  0.1780  0.0637
 0.0316  0.0213  0.1589  0.0051  0.0060  0.0017  0.6751  0.0088  0.0847  0.0068
 0.0129  0.0181  0.0105  0.0184  0.2055  0.1715  0.0176  0.0043  0.0193  0.5218
 0.0021  0.0008  0.9792  0.0013  0.0020  0.0004  0.0062  0.0013  0.0045  0.0023
 0.0152  0.0123  0.0343  0.0100  0.0039  0.0016  0.0259  0.0105  0.8819  0.0044
 0.0409  0.0226  0.3134  0.0090  0.0106  0.0032  0.4625  0.0157  0.1112  0.0110
 0.1905  0.4393  0.1068  0.0256  0.0179  0.0146  0.0753  0.0206  0.0970  0.0125
 0.0096  0.0107  0.0066  0.0007  0.0019  0.0036  0.0116  0.9443  0.0074  0.0036
 0.0229  0.0198  0.0550  0.0094  0.0065  0.0018  0.4529  0.0116  0.4121  0.0081
 0.0693  0.8537  0.0154  0.0134  0.0036  0.0034  0.0176  0.0061  0.0156  0.0018
 0.0530  0.0257  0.3611  0.0133  0.0111  0.0030  0.3208  0.0120  0.1886  0.0114
 0.0086  0.0046  0.9338  0.0037  0.0053  0.0014  0.0197  0.0038  0.0139  0.0053
[torch.cuda.FloatTensor of size 16x10 (GPU 1)]
, 
 0
 1
 6
 1
 8
 6
 9
 2
 8
 6
 1
 7
 6
 1
 2
 2
[torch.cuda.LongTensor of size 16 (GPU 1)]
, Variable containing:
 3
 1
 6
 1
 8
 6
 5
 2
 8
 6
 1
 7
 6
 1
 0
 2
[torch.cuda.LongTensor of size 16 (GPU 1)]
)
685/960 correct, 0.714%, avg loss: 3.07332319468
(915, 973)
Epoch: 10, Step: 4900, Train Loss: 1.12, Val Loss: 0.03, Val acc: 0.940
Param Norm1: 65214.66, grad Norm1: 81.91, Param Norm12: 89.66, grad Norm2: 1.00
(976, 973)
Epoch: 10, Step: 5000, Train Loss: 1.16, Val Loss: 0.04, Val acc: 1.003
Param Norm1: 65669.69, grad Norm1: 101.04, Param Norm12: 90.30, grad Norm2: 1.00
(915, 973)
Epoch: 10, Step: 5100, Train Loss: 1.15, Val Loss: 0.04, Val acc: 0.940
Param Norm1: 66254.15, grad Norm1: 112.88, Param Norm12: 91.05, grad Norm2: 1.00
(976, 973)
Epoch: 10, Step: 5200, Train Loss: 1.09, Val Loss: 0.01, Val acc: 1.003
Param Norm1: 66815.32, grad Norm1: 95.57, Param Norm12: 91.84, grad Norm2: 1.00
(793, 973)
Epoch: 10, Step: 5300, Train Loss: 1.15, Val Loss: 0.06, Val acc: 0.815
Param Norm1: 67214.41, grad Norm1: 101.25, Param Norm12: 92.41, grad Norm2: 1.00
('LR changed to', 0.0008100000000000001)
Evaluating on training set
Processed 0 batches
(Variable containing:
 0.0386  0.9084  0.0106  0.0157  0.0034  0.0031  0.0072  0.0050  0.0059  0.0020
 0.4276  0.3616  0.0285  0.0396  0.0257  0.0226  0.0339  0.0137  0.0329  0.0139
 0.0067  0.0017  0.9680  0.0029  0.0059  0.0007  0.0033  0.0021  0.0061  0.0027
 0.0113  0.0218  0.0116  0.0221  0.2669  0.0682  0.0177  0.0023  0.0266  0.5515
 0.0398  0.9116  0.0097  0.0145  0.0031  0.0027  0.0069  0.0045  0.0052  0.0018
 0.0185  0.9289  0.0057  0.0169  0.0042  0.0074  0.0071  0.0032  0.0055  0.0026
 0.0130  0.0040  0.9406  0.0035  0.0078  0.0011  0.0108  0.0041  0.0116  0.0034
 0.0154  0.9566  0.0044  0.0082  0.0018  0.0025  0.0028  0.0038  0.0031  0.0013
 0.0318  0.9241  0.0085  0.0131  0.0030  0.0029  0.0059  0.0045  0.0045  0.0017
 0.1017  0.0465  0.5126  0.0307  0.0435  0.0131  0.0540  0.0519  0.1163  0.0297
 0.0208  0.9494  0.0046  0.0085  0.0024  0.0024  0.0044  0.0029  0.0030  0.0017
 0.0073  0.0189  0.0062  0.0007  0.0031  0.0041  0.0066  0.9404  0.0080  0.0047
 0.0063  0.0141  0.0092  0.0009  0.0052  0.0059  0.0076  0.9349  0.0085  0.0075
 0.0042  0.0105  0.0063  0.0005  0.0031  0.0041  0.0063  0.9544  0.0060  0.0045
 0.0058  0.0124  0.0078  0.0008  0.0047  0.0052  0.0077  0.9405  0.0081  0.0070
 0.0165  0.0090  0.0151  0.0061  0.0031  0.0007  0.0124  0.0040  0.9305  0.0026
[torch.cuda.FloatTensor of size 16x10 (GPU 1)]
, 
 1
 0
 2
 9
 1
 1
 2
 1
 1
 2
 1
 7
 7
 7
 7
 8
[torch.cuda.LongTensor of size 16 (GPU 1)]
, Variable containing:
 1
 1
 2
 9
 1
 1
 2
 1
 1
 2
 1
 7
 7
 7
 7
 8
[torch.cuda.LongTensor of size 16 (GPU 1)]
)
Processed 100 batches
Processed 200 batches
Processed 300 batches
Processed 400 batches
7027/7792 correct, 0.902%, avg loss: 0.91220754899
Evaluating on validation set
Processed 0 batches
(Variable containing:
 0.0362  0.9163  0.0097  0.0141  0.0029  0.0027  0.0065  0.0046  0.0053  0.0017
 0.0207  0.0051  0.9069  0.0052  0.0047  0.0009  0.0262  0.0033  0.0243  0.0028
 0.1431  0.0685  0.2990  0.0328  0.0261  0.0154  0.1429  0.0979  0.1483  0.0260
 0.1284  0.7551  0.0235  0.0328  0.0057  0.0051  0.0167  0.0105  0.0174  0.0047
 0.0520  0.0336  0.0140  0.8492  0.0100  0.0015  0.0047  0.0028  0.0242  0.0081
 0.0081  0.0113  0.0019  0.9660  0.0034  0.0003  0.0009  0.0008  0.0046  0.0026
 0.0059  0.0127  0.0069  0.0006  0.0034  0.0042  0.0073  0.9468  0.0069  0.0053
 0.0583  0.0144  0.3621  0.0089  0.0056  0.0012  0.3651  0.0128  0.1684  0.0033
 0.0073  0.0187  0.0072  0.0007  0.0038  0.0052  0.0071  0.9361  0.0083  0.0057
 0.0757  0.7671  0.0201  0.0352  0.0213  0.0142  0.0242  0.0058  0.0116  0.0248
 0.1006  0.0276  0.5879  0.0156  0.0138  0.0040  0.1067  0.0154  0.1186  0.0097
 0.0479  0.8964  0.0117  0.0163  0.0035  0.0030  0.0080  0.0050  0.0063  0.0020
 0.0204  0.0076  0.8784  0.0079  0.0144  0.0033  0.0082  0.0102  0.0404  0.0092
 0.0118  0.0226  0.0146  0.0147  0.4603  0.0731  0.0199  0.0023  0.0197  0.3610
 0.3207  0.3708  0.0779  0.0686  0.0279  0.0195  0.0354  0.0244  0.0329  0.0220
 0.1966  0.0469  0.2528  0.0287  0.0127  0.0034  0.1906  0.0117  0.2484  0.0081
[torch.cuda.FloatTensor of size 16x10 (GPU 1)]
, 
 1
 2
 2
 1
 3
 3
 7
 6
 7
 1
 2
 1
 2
 4
 1
 2
[torch.cuda.LongTensor of size 16 (GPU 1)]
, Variable containing:
 0
 2
 8
 1
 3
 3
 7
 8
 7
 1
 2
 0
 2
 9
 1
 8
[torch.cuda.LongTensor of size 16 (GPU 1)]
)
687/960 correct, 0.716%, avg loss: 3.06076872448
(976, 973)
Epoch: 11, Step: 5400, Train Loss: 1.19, Val Loss: 0.02, Val acc: 1.003
Param Norm1: 67541.95, grad Norm1: 91.11, Param Norm12: 92.88, grad Norm2: 1.00
(915, 973)
Epoch: 11, Step: 5500, Train Loss: 1.02, Val Loss: 0.04, Val acc: 0.940
Param Norm1: 67929.90, grad Norm1: 99.08, Param Norm12: 93.47, grad Norm2: 1.00
(793, 973)
Epoch: 11, Step: 5600, Train Loss: 1.03, Val Loss: 0.07, Val acc: 0.815
Param Norm1: 68309.13, grad Norm1: 105.12, Param Norm12: 93.95, grad Norm2: 1.00
(915, 973)
Epoch: 11, Step: 5700, Train Loss: 1.09, Val Loss: 0.03, Val acc: 0.940
Param Norm1: 68726.78, grad Norm1: 121.23, Param Norm12: 94.46, grad Norm2: 1.00
(976, 973)
Epoch: 11, Step: 5800, Train Loss: 1.00, Val Loss: 0.03, Val acc: 1.003
Param Norm1: 69055.51, grad Norm1: 121.40, Param Norm12: 94.93, grad Norm2: 1.00
Evaluating on training set
Processed 0 batches
(Variable containing:
 0.0014  0.0047  0.0013  0.0001  0.0007  0.0010  0.0026  0.9836  0.0027  0.0017
 0.0023  0.0062  0.0018  0.0001  0.0012  0.0012  0.0032  0.9780  0.0039  0.0020
 0.0013  0.0041  0.0011  0.0002  0.0009  0.0012  0.0033  0.9828  0.0027  0.0025
 0.1783  0.7136  0.0171  0.0441  0.0069  0.0040  0.0098  0.0077  0.0126  0.0059
 0.0074  0.9784  0.0034  0.0024  0.0010  0.0009  0.0022  0.0017  0.0017  0.0007
 0.0062  0.9814  0.0029  0.0021  0.0009  0.0009  0.0019  0.0016  0.0015  0.0006
 0.0072  0.0007  0.9746  0.0014  0.0027  0.0004  0.0052  0.0012  0.0041  0.0025
 0.8620  0.0223  0.0264  0.0252  0.0116  0.0013  0.0161  0.0048  0.0218  0.0086
 0.0532  0.8840  0.0101  0.0227  0.0042  0.0025  0.0059  0.0046  0.0093  0.0035
 0.0056  0.0062  0.0019  0.9733  0.0037  0.0003  0.0009  0.0009  0.0041  0.0030
 0.0065  0.0150  0.0026  0.9617  0.0053  0.0006  0.0007  0.0011  0.0032  0.0033
 0.0019  0.0004  0.9914  0.0005  0.0008  0.0001  0.0024  0.0004  0.0017  0.0005
 0.0028  0.0004  0.9900  0.0006  0.0011  0.0001  0.0020  0.0006  0.0017  0.0007
 0.0502  0.0210  0.0949  0.0473  0.1858  0.0501  0.0399  0.0308  0.0531  0.4269
 0.0042  0.9850  0.0023  0.0019  0.0008  0.0009  0.0014  0.0015  0.0014  0.0006
 0.0104  0.9735  0.0034  0.0026  0.0011  0.0011  0.0028  0.0022  0.0021  0.0009
[torch.cuda.FloatTensor of size 16x10 (GPU 1)]
, 
 7
 7
 7
 1
 1
 1
 2
 0
 1
 3
 3
 2
 2
 9
 1
 1
[torch.cuda.LongTensor of size 16 (GPU 1)]
, Variable containing:
 7
 7
 7
 0
 1
 1
 2
 0
 0
 3
 3
 2
 2
 9
 1
 1
[torch.cuda.LongTensor of size 16 (GPU 1)]
)
Processed 100 batches
Processed 200 batches
Processed 300 batches
Processed 400 batches
7071/7792 correct, 0.907%, avg loss: 0.904403854123
Evaluating on validation set
Processed 0 batches
(Variable containing:
 0.1228  0.0541  0.4338  0.0212  0.0231  0.0104  0.0773  0.0981  0.1390  0.0203
 0.0799  0.8664  0.0079  0.0180  0.0036  0.0029  0.0063  0.0053  0.0061  0.0035
 0.0098  0.0223  0.0036  0.9437  0.0058  0.0009  0.0021  0.0018  0.0055  0.0044
 0.0524  0.8856  0.0102  0.0223  0.0040  0.0024  0.0059  0.0046  0.0092  0.0034
 0.0130  0.9574  0.0081  0.0062  0.0020  0.0014  0.0040  0.0026  0.0040  0.0013
 0.0031  0.0055  0.0011  0.9816  0.0029  0.0002  0.0005  0.0006  0.0023  0.0021
 0.1308  0.7719  0.0610  0.0109  0.0051  0.0010  0.0074  0.0026  0.0073  0.0020
 0.9525  0.0188  0.0080  0.0023  0.0024  0.0004  0.0060  0.0013  0.0062  0.0022
 0.0074  0.9789  0.0032  0.0026  0.0010  0.0009  0.0021  0.0016  0.0017  0.0007
 0.0016  0.0052  0.0023  0.0001  0.0011  0.0014  0.0037  0.9781  0.0041  0.0024
 0.0670  0.0271  0.3637  0.0118  0.0124  0.0048  0.0988  0.0325  0.3673  0.0147
 0.0465  0.0188  0.0612  0.0039  0.0059  0.0014  0.7582  0.0156  0.0812  0.0073
 0.0115  0.9702  0.0046  0.0028  0.0014  0.0009  0.0029  0.0025  0.0020  0.0011
 0.0146  0.0075  0.0081  0.0028  0.0023  0.0009  0.0426  0.0086  0.9094  0.0032
 0.0204  0.0106  0.7674  0.0107  0.0103  0.0015  0.0322  0.0062  0.1339  0.0068
 0.0037  0.9866  0.0020  0.0015  0.0007  0.0009  0.0012  0.0016  0.0013  0.0005
[torch.cuda.FloatTensor of size 16x10 (GPU 1)]
, 
 2
 1
 3
 1
 1
 3
 1
 0
 1
 7
 8
 6
 1
 8
 2
 1
[torch.cuda.LongTensor of size 16 (GPU 1)]
, Variable containing:
 2
 0
 3
 0
 1
 3
 1
 0
 1
 7
 8
 2
 1
 6
 2
 1
[torch.cuda.LongTensor of size 16 (GPU 1)]
)
688/960 correct, 0.717%, avg loss: 4.20959467987
(915, 973)
Epoch: 12, Step: 5900, Train Loss: 0.94, Val Loss: 0.02, Val acc: 0.940
Param Norm1: 69384.60, grad Norm1: 142.55, Param Norm12: 95.38, grad Norm2: 1.00
(976, 973)
Epoch: 12, Step: 6000, Train Loss: 0.78, Val Loss: 0.01, Val acc: 1.003
Param Norm1: 69893.59, grad Norm1: 81.99, Param Norm12: 96.07, grad Norm2: 1.00
(915, 973)
Epoch: 12, Step: 6100, Train Loss: 0.93, Val Loss: 0.06, Val acc: 0.940
Param Norm1: 70286.05, grad Norm1: 77.17, Param Norm12: 96.64, grad Norm2: 1.00
(854, 973)
Epoch: 12, Step: 6200, Train Loss: 1.03, Val Loss: 0.05, Val acc: 0.878
Param Norm1: 70600.83, grad Norm1: 117.47, Param Norm12: 97.09, grad Norm2: 1.00
(976, 973)
Epoch: 12, Step: 6300, Train Loss: 1.03, Val Loss: 0.02, Val acc: 1.003
Param Norm1: 71009.02, grad Norm1: 112.16, Param Norm12: 97.63, grad Norm2: 1.00
Evaluating on training set
Processed 0 batches
(Variable containing:
 0.0327  0.0154  0.0296  0.0174  0.4327  0.0725  0.0565  0.0555  0.0642  0.2235
 0.0084  0.9728  0.0025  0.0038  0.0012  0.0017  0.0026  0.0031  0.0029  0.0010
 0.9786  0.0054  0.0027  0.0017  0.0014  0.0005  0.0040  0.0012  0.0035  0.0010
 0.0032  0.0049  0.0009  0.9822  0.0027  0.0002  0.0005  0.0007  0.0031  0.0017
 0.0403  0.9189  0.0039  0.0123  0.0024  0.0022  0.0060  0.0061  0.0060  0.0020
 0.0479  0.0154  0.1493  0.0115  0.0099  0.0023  0.3419  0.0135  0.4012  0.0072
 0.9724  0.0094  0.0024  0.0038  0.0027  0.0006  0.0026  0.0013  0.0036  0.0013
 0.0024  0.0009  0.9847  0.0007  0.0013  0.0001  0.0041  0.0005  0.0047  0.0006
 0.9132  0.0042  0.0266  0.0046  0.0039  0.0003  0.0298  0.0010  0.0145  0.0018
 0.9139  0.0414  0.0070  0.0122  0.0048  0.0013  0.0083  0.0017  0.0070  0.0024
 0.0236  0.0262  0.0123  0.8868  0.0112  0.0023  0.0032  0.0050  0.0214  0.0081
 0.0091  0.0484  0.0031  0.9134  0.0058  0.0008  0.0020  0.0020  0.0118  0.0036
 0.0367  0.0085  0.2158  0.0053  0.0083  0.0018  0.6309  0.0178  0.0647  0.0101
 0.0509  0.0426  0.0774  0.0118  0.0204  0.0238  0.0904  0.5319  0.1263  0.0246
 0.0137  0.0329  0.0022  0.9321  0.0064  0.0009  0.0011  0.0017  0.0061  0.0030
 0.0241  0.0103  0.0310  0.0107  0.0547  0.0131  0.7714  0.0012  0.0314  0.0521
[torch.cuda.FloatTensor of size 16x10 (GPU 1)]
, 
 4
 1
 0
 3
 1
 8
 0
 2
 0
 0
 3
 3
 6
 7
 3
 6
[torch.cuda.LongTensor of size 16 (GPU 1)]
, Variable containing:
 4
 1
 0
 3
 1
 2
 0
 2
 0
 0
 3
 3
 6
 7
 3
 6
[torch.cuda.LongTensor of size 16 (GPU 1)]
)
Processed 100 batches
Processed 200 batches
Processed 300 batches
Processed 400 batches
7177/7792 correct, 0.921%, avg loss: 0.72929738898
Evaluating on validation set
Processed 0 batches
(Variable containing:
 0.0014  0.0032  0.0017  0.0003  0.0013  0.0015  0.0067  0.9764  0.0047  0.0028
 0.0035  0.0012  0.9769  0.0011  0.0031  0.0004  0.0058  0.0012  0.0056  0.0011
 0.0449  0.0102  0.1984  0.0120  0.2119  0.0616  0.1063  0.0338  0.1188  0.2022
 0.0276  0.0166  0.0108  0.0100  0.0037  0.0016  0.0095  0.0080  0.9084  0.0037
 0.6489  0.2351  0.0335  0.0123  0.0063  0.0023  0.0305  0.0033  0.0255  0.0025
 0.0734  0.8573  0.0065  0.0184  0.0045  0.0044  0.0113  0.0089  0.0097  0.0055
 0.0180  0.9477  0.0058  0.0090  0.0022  0.0021  0.0061  0.0030  0.0049  0.0012
 0.0039  0.0022  0.0047  0.0032  0.0017  0.0005  0.0042  0.0032  0.9748  0.0017
 0.0116  0.0853  0.0037  0.8669  0.0063  0.0014  0.0019  0.0039  0.0149  0.0042
 0.0017  0.0032  0.0019  0.0006  0.0025  0.0018  0.0111  0.9663  0.0078  0.0031
 0.0139  0.9618  0.0036  0.0060  0.0015  0.0017  0.0042  0.0028  0.0035  0.0010
 0.0064  0.9780  0.0019  0.0040  0.0010  0.0014  0.0021  0.0022  0.0022  0.0007
 0.0020  0.0049  0.0024  0.0003  0.0015  0.0020  0.0046  0.9745  0.0049  0.0029
 0.0076  0.0028  0.9517  0.0023  0.0029  0.0004  0.0178  0.0015  0.0114  0.0015
 0.0130  0.0173  0.1568  0.0114  0.0104  0.0028  0.3731  0.0378  0.3673  0.0102
 0.1238  0.0704  0.2624  0.0484  0.0446  0.0169  0.0985  0.1022  0.2003  0.0324
[torch.cuda.FloatTensor of size 16x10 (GPU 1)]
, 
 7
 2
 4
 8
 0
 1
 1
 8
 3
 7
 1
 1
 7
 2
 6
 2
[torch.cuda.LongTensor of size 16 (GPU 1)]
, Variable containing:
 7
 1
 9
 8
 1
 1
 1
 2
 3
 7
 0
 1
 7
 2
 2
 6
[torch.cuda.LongTensor of size 16 (GPU 1)]
)
673/960 correct, 0.701%, avg loss: 4.0324139148
(976, 973)
Epoch: 13, Step: 6400, Train Loss: 0.85, Val Loss: 0.00, Val acc: 1.003
Param Norm1: 71425.78, grad Norm1: 106.28, Param Norm12: 98.21, grad Norm2: 1.00
(976, 973)
Epoch: 13, Step: 6500, Train Loss: 0.83, Val Loss: 0.01, Val acc: 1.003
Param Norm1: 71850.34, grad Norm1: 102.38, Param Norm12: 98.79, grad Norm2: 1.00
(915, 973)
Epoch: 13, Step: 6600, Train Loss: 0.91, Val Loss: 0.01, Val acc: 0.940
Param Norm1: 72301.79, grad Norm1: 82.19, Param Norm12: 99.37, grad Norm2: 1.00
(915, 973)
Epoch: 13, Step: 6700, Train Loss: 0.84, Val Loss: 0.03, Val acc: 0.940
Param Norm1: 72650.21, grad Norm1: 109.45, Param Norm12: 99.85, grad Norm2: 1.00
(854, 973)
Epoch: 13, Step: 6800, Train Loss: 0.94, Val Loss: 0.04, Val acc: 0.878
Param Norm1: 72998.52, grad Norm1: 108.15, Param Norm12: 100.36, grad Norm2: 1.00
Evaluating on training set
Processed 0 batches
(Variable containing:
 0.3418  0.0584  0.0702  0.0776  0.0131  0.0085  0.1162  0.0489  0.2455  0.0198
 0.9648  0.0085  0.0043  0.0010  0.0013  0.0002  0.0103  0.0015  0.0075  0.0006
 0.0068  0.9801  0.0021  0.0024  0.0007  0.0011  0.0020  0.0018  0.0025  0.0005
 0.0371  0.9297  0.0073  0.0070  0.0016  0.0017  0.0036  0.0043  0.0060  0.0015
 0.0010  0.0035  0.0003  0.0002  0.0005  0.9793  0.0021  0.0004  0.0031  0.0097
 0.0060  0.9783  0.0027  0.0033  0.0008  0.0014  0.0017  0.0017  0.0035  0.0006
 0.9804  0.0053  0.0013  0.0026  0.0013  0.0002  0.0032  0.0014  0.0035  0.0009
 0.0582  0.0519  0.1695  0.0104  0.0054  0.0038  0.1017  0.0351  0.5608  0.0032
 0.4685  0.0143  0.1496  0.0216  0.0527  0.0139  0.0579  0.0285  0.1376  0.0554
 0.0079  0.0025  0.9607  0.0031  0.0014  0.0003  0.0064  0.0005  0.0154  0.0020
 0.0083  0.9743  0.0027  0.0041  0.0009  0.0014  0.0023  0.0017  0.0035  0.0008
 0.0084  0.0125  0.0280  0.0089  0.2322  0.0589  0.0571  0.0008  0.0147  0.5784
 0.0051  0.0036  0.0030  0.0064  0.0360  0.0160  0.0080  0.0017  0.0070  0.9131
 0.0561  0.0075  0.1103  0.0096  0.3465  0.0622  0.0278  0.0139  0.0835  0.2826
 0.0015  0.0094  0.0023  0.0002  0.0009  0.0013  0.0033  0.9749  0.0038  0.0024
 0.0447  0.8666  0.0266  0.0144  0.0030  0.0033  0.0145  0.0059  0.0186  0.0023
[torch.cuda.FloatTensor of size 16x10 (GPU 1)]
, 
 0
 0
 1
 1
 5
 1
 0
 8
 0
 2
 1
 9
 9
 4
 7
 1
[torch.cuda.LongTensor of size 16 (GPU 1)]
, Variable containing:
 0
 0
 1
 1
 5
 1
 0
 8
 0
 2
 1
 4
 9
 4
 7
 1
[torch.cuda.LongTensor of size 16 (GPU 1)]
)
Processed 100 batches
Processed 200 batches
Processed 300 batches
Processed 400 batches
7197/7792 correct, 0.924%, avg loss: 0.684640117196
Evaluating on validation set
Processed 0 batches
(Variable containing:
 0.0124  0.0153  0.0100  0.0095  0.1296  0.0575  0.0284  0.0025  0.0184  0.7163
 0.0394  0.0086  0.0460  0.0034  0.0034  0.0008  0.8310  0.0068  0.0546  0.0062
 0.0046  0.0015  0.9729  0.0015  0.0033  0.0007  0.0027  0.0016  0.0069  0.0043
 0.0011  0.0049  0.0030  0.0003  0.0009  0.0012  0.0020  0.9812  0.0028  0.0027
 0.0027  0.0006  0.9877  0.0016  0.0007  0.0001  0.0015  0.0005  0.0037  0.0009
 0.9279  0.0397  0.0062  0.0065  0.0020  0.0007  0.0058  0.0014  0.0080  0.0019
 0.0014  0.0045  0.0017  0.0002  0.0011  0.0008  0.0027  0.9820  0.0031  0.0024
 0.0506  0.0168  0.1030  0.0071  0.0061  0.0014  0.1755  0.0058  0.6278  0.0060
 0.0216  0.0069  0.7241  0.0099  0.0047  0.0024  0.0890  0.0313  0.0992  0.0108
 0.0125  0.0085  0.0307  0.0310  0.3096  0.0203  0.0207  0.0020  0.0334  0.5312
 0.0010  0.0043  0.0017  0.0002  0.0007  0.0010  0.0023  0.9839  0.0026  0.0022
 0.0608  0.8589  0.0223  0.0155  0.0029  0.0030  0.0112  0.0053  0.0180  0.0021
 0.0280  0.9385  0.0071  0.0068  0.0015  0.0018  0.0055  0.0030  0.0067  0.0011
 0.0165  0.9607  0.0043  0.0044  0.0011  0.0015  0.0039  0.0024  0.0045  0.0008
 0.0011  0.0054  0.0020  0.0002  0.0007  0.0010  0.0025  0.9823  0.0027  0.0022
 0.1054  0.8357  0.0196  0.0093  0.0026  0.0030  0.0053  0.0073  0.0090  0.0028
[torch.cuda.FloatTensor of size 16x10 (GPU 1)]
, 
 9
 6
 2
 7
 2
 0
 7
 8
 2
 9
 7
 1
 1
 1
 7
 1
[torch.cuda.LongTensor of size 16 (GPU 1)]
, Variable containing:
 9
 2
 2
 7
 2
 0
 7
 2
 2
 9
 7
 1
 1
 1
 7
 1
[torch.cuda.LongTensor of size 16 (GPU 1)]
)
680/960 correct, 0.708%, avg loss: 4.07172371149
(976, 973)
Epoch: 14, Step: 6900, Train Loss: 0.79, Val Loss: 0.03, Val acc: 1.003
Param Norm1: 73306.49, grad Norm1: 104.43, Param Norm12: 100.77, grad Norm2: 1.00
(854, 973)
Epoch: 14, Step: 7000, Train Loss: 0.78, Val Loss: 0.05, Val acc: 0.878
Param Norm1: 73719.30, grad Norm1: 137.69, Param Norm12: 101.31, grad Norm2: 1.00
(976, 973)
Epoch: 14, Step: 7100, Train Loss: 0.67, Val Loss: 0.01, Val acc: 1.003
Param Norm1: 74224.98, grad Norm1: 89.75, Param Norm12: 101.89, grad Norm2: 1.00
(915, 973)
Epoch: 14, Step: 7200, Train Loss: 0.91, Val Loss: 0.03, Val acc: 0.940
Param Norm1: 74542.85, grad Norm1: 113.21, Param Norm12: 102.32, grad Norm2: 1.00
(976, 973)
Epoch: 14, Step: 7300, Train Loss: 0.87, Val Loss: 0.01, Val acc: 1.003
Param Norm1: 74919.09, grad Norm1: 121.30, Param Norm12: 102.82, grad Norm2: 1.00
Evaluating on training set
Processed 0 batches
(Variable containing:
 0.0016  0.0036  0.0009  0.9871  0.0024  0.0002  0.0003  0.0004  0.0026  0.0008
 0.8217  0.0564  0.0430  0.0053  0.0057  0.0019  0.0130  0.0033  0.0433  0.0064
 0.0007  0.0005  0.0001  0.0001  0.0007  0.9963  0.0002  0.0002  0.0008  0.0004
 0.0046  0.9867  0.0016  0.0015  0.0005  0.0007  0.0012  0.0010  0.0019  0.0002
 0.9873  0.0042  0.0009  0.0007  0.0004  0.0021  0.0032  0.0005  0.0003  0.0004
 0.0080  0.0192  0.0195  0.0036  0.0026  0.0014  0.1440  0.0102  0.7875  0.0039
 0.1127  0.0759  0.2873  0.0355  0.0152  0.0135  0.0746  0.1292  0.2363  0.0197
 0.0055  0.0035  0.0168  0.0013  0.0010  0.0003  0.9372  0.0031  0.0296  0.0016
 0.0013  0.9925  0.0010  0.0009  0.0004  0.0007  0.0005  0.0010  0.0015  0.0002
 0.0006  0.0003  0.9934  0.0003  0.0007  0.0001  0.0005  0.0004  0.0030  0.0006
 0.0942  0.8571  0.0167  0.0080  0.0023  0.0017  0.0051  0.0035  0.0099  0.0015
 0.0373  0.9181  0.0096  0.0093  0.0021  0.0018  0.0042  0.0042  0.0124  0.0012
 0.0030  0.0200  0.0107  0.0024  0.0012  0.0010  0.0435  0.0083  0.9074  0.0024
 0.0577  0.8660  0.0263  0.0111  0.0030  0.0027  0.0072  0.0060  0.0180  0.0019
 0.9559  0.0218  0.0021  0.0032  0.0018  0.0005  0.0031  0.0022  0.0081  0.0013
 0.0425  0.0106  0.1544  0.0040  0.0078  0.0020  0.6562  0.0174  0.0927  0.0125
[torch.cuda.FloatTensor of size 16x10 (GPU 1)]
, 
 3
 0
 5
 1
 0
 8
 2
 6
 1
 2
 1
 1
 8
 1
 0
 6
[torch.cuda.LongTensor of size 16 (GPU 1)]
, Variable containing:
 3
 0
 5
 1
 0
 8
 6
 6
 1
 2
 0
 0
 8
 0
 0
 6
[torch.cuda.LongTensor of size 16 (GPU 1)]
)
Processed 100 batches
Processed 200 batches
Processed 300 batches
Processed 400 batches
7223/7792 correct, 0.927%, avg loss: 0.709369623758
Evaluating on validation set
Processed 0 batches
(Variable containing:
 0.0226  0.0148  0.0621  0.0028  0.0035  0.0022  0.0254  0.0117  0.8508  0.0040
 0.0461  0.0278  0.4541  0.0035  0.0056  0.0021  0.1085  0.0069  0.3394  0.0062
 0.0919  0.0327  0.5445  0.0162  0.0143  0.0096  0.0454  0.0737  0.1569  0.0146
 0.0340  0.9363  0.0056  0.0063  0.0019  0.0026  0.0014  0.0040  0.0062  0.0017
 0.0056  0.9849  0.0017  0.0017  0.0006  0.0007  0.0014  0.0010  0.0021  0.0003
 0.0013  0.0007  0.9888  0.0006  0.0007  0.0002  0.0009  0.0011  0.0053  0.0004
 0.0614  0.0321  0.5751  0.0035  0.0061  0.0057  0.1203  0.0687  0.1198  0.0074
 0.0023  0.0011  0.9782  0.0006  0.0009  0.0002  0.0081  0.0010  0.0067  0.0008
 0.0079  0.9805  0.0024  0.0020  0.0007  0.0008  0.0016  0.0012  0.0026  0.0003
 0.0203  0.9551  0.0054  0.0047  0.0013  0.0012  0.0038  0.0018  0.0057  0.0007
 0.0176  0.9599  0.0026  0.0052  0.0011  0.0009  0.0033  0.0031  0.0051  0.0011
 0.8411  0.0876  0.0257  0.0082  0.0027  0.0044  0.0056  0.0020  0.0202  0.0025
 0.0169  0.0141  0.0454  0.0031  0.0033  0.0015  0.0409  0.0059  0.8658  0.0031
 0.0019  0.0047  0.0076  0.0003  0.0028  0.0014  0.0013  0.9714  0.0069  0.0016
 0.0056  0.0051  0.0129  0.0011  0.0021  0.0011  0.0074  0.0062  0.9562  0.0022
 0.0017  0.0011  0.9838  0.0012  0.0036  0.0004  0.0006  0.0015  0.0048  0.0012
[torch.cuda.FloatTensor of size 16x10 (GPU 1)]
, 
 8
 2
 2
 1
 1
 2
 2
 2
 1
 1
 1
 0
 8
 7
 8
 2
[torch.cuda.LongTensor of size 16 (GPU 1)]
, Variable containing:
 8
 2
 8
 1
 1
 2
 8
 2
 1
 0
 1
 1
 2
 7
 0
 2
[torch.cuda.LongTensor of size 16 (GPU 1)]
)
680/960 correct, 0.708%, avg loss: 4.97815534671
(976, 973)
Epoch: 15, Step: 7400, Train Loss: 0.57, Val Loss: 0.01, Val acc: 1.003
Param Norm1: 75335.51, grad Norm1: 96.09, Param Norm12: 103.40, grad Norm2: 1.00
(915, 973)
Epoch: 15, Step: 7500, Train Loss: 0.72, Val Loss: 0.07, Val acc: 0.940
Param Norm1: 75701.38, grad Norm1: 98.61, Param Norm12: 103.89, grad Norm2: 1.00
(915, 973)
Epoch: 15, Step: 7600, Train Loss: 0.81, Val Loss: 0.02, Val acc: 0.940
Param Norm1: 76056.75, grad Norm1: 96.53, Param Norm12: 104.36, grad Norm2: 1.00
(915, 973)
Epoch: 15, Step: 7700, Train Loss: 0.81, Val Loss: 0.03, Val acc: 0.940
Param Norm1: 76515.65, grad Norm1: 120.03, Param Norm12: 104.96, grad Norm2: 1.00
Evaluating on training set
Processed 0 batches
(Variable containing:
 0.0029  0.9844  0.0012  0.0031  0.0007  0.0011  0.0016  0.0025  0.0019  0.0007
 0.0107  0.0282  0.0025  0.0062  0.0488  0.1384  0.0197  0.0014  0.0141  0.7300
 0.0238  0.9447  0.0048  0.0100  0.0013  0.0020  0.0043  0.0028  0.0050  0.0013
 0.0042  0.0024  0.9725  0.0013  0.0011  0.0003  0.0096  0.0014  0.0064  0.0009
 0.0038  0.9867  0.0016  0.0024  0.0004  0.0008  0.0012  0.0014  0.0014  0.0003
 0.0246  0.0164  0.0334  0.0042  0.0042  0.0028  0.0564  0.0166  0.8340  0.0074
 0.1164  0.0568  0.3454  0.0585  0.0160  0.0129  0.0864  0.1115  0.1776  0.0185
 0.0047  0.0055  0.0052  0.0008  0.0017  0.0016  0.0048  0.9667  0.0060  0.0031
 0.0006  0.0006  0.9931  0.0004  0.0004  0.0001  0.0003  0.0007  0.0035  0.0004
 0.0018  0.0008  0.9903  0.0005  0.0008  0.0002  0.0017  0.0006  0.0027  0.0006
 0.9625  0.0079  0.0024  0.0076  0.0021  0.0005  0.0042  0.0005  0.0108  0.0013
 0.9540  0.0266  0.0033  0.0038  0.0011  0.0004  0.0034  0.0006  0.0058  0.0011
 0.0005  0.0004  0.9952  0.0003  0.0007  0.0001  0.0004  0.0002  0.0019  0.0003
 0.0112  0.0060  0.0275  0.0016  0.0019  0.0004  0.8974  0.0021  0.0490  0.0029
 0.1164  0.0568  0.3454  0.0585  0.0160  0.0129  0.0864  0.1115  0.1776  0.0185
 0.0481  0.8977  0.0123  0.0196  0.0032  0.0033  0.0041  0.0039  0.0061  0.0018
[torch.cuda.FloatTensor of size 16x10 (GPU 1)]
, 
 1
 9
 1
 2
 1
 8
 2
 7
 2
 2
 0
 0
 2
 6
 2
 1
[torch.cuda.LongTensor of size 16 (GPU 1)]
, Variable containing:
 1
 9
 1
 2
 1
 8
 2
 7
 2
 2
 0
 0
 2
 6
 2
 1
[torch.cuda.LongTensor of size 16 (GPU 1)]
)
Processed 100 batches
Processed 200 batches
Processed 300 batches
Processed 400 batches
7331/7792 correct, 0.941%, avg loss: 0.529966664143
Evaluating on validation set
Processed 0 batches
(Variable containing:
 0.3652  0.0691  0.0578  0.0429  0.2253  0.0113  0.0921  0.0044  0.0827  0.0491
 0.0120  0.0139  0.2169  0.0026  0.0028  0.0006  0.7013  0.0045  0.0422  0.0032
 0.0092  0.0066  0.9065  0.0034  0.0025  0.0006  0.0176  0.0016  0.0494  0.0025
 0.0056  0.0030  0.0014  0.9795  0.0020  0.0002  0.0005  0.0007  0.0061  0.0010
 0.0520  0.0134  0.0298  0.0060  0.0031  0.0010  0.7729  0.0077  0.1078  0.0062
 0.0003  0.0006  0.9942  0.0002  0.0003  0.0001  0.0023  0.0002  0.0016  0.0003
 0.0198  0.0226  0.0055  0.0123  0.4670  0.1318  0.0301  0.0031  0.0176  0.2901
 0.0281  0.0096  0.8709  0.0029  0.0030  0.0006  0.0403  0.0017  0.0405  0.0024
 0.0100  0.0019  0.0260  0.0005  0.0006  0.0001  0.9490  0.0026  0.0060  0.0031
 0.9949  0.0012  0.0006  0.0013  0.0005  0.0001  0.0005  0.0002  0.0005  0.0001
 0.0107  0.0100  0.0045  0.0010  0.0028  0.0012  0.0116  0.9456  0.0087  0.0039
 0.0106  0.0036  0.9331  0.0024  0.0022  0.0006  0.0242  0.0024  0.0191  0.0018
 0.0288  0.0237  0.2557  0.0090  0.0094  0.0093  0.0922  0.0408  0.5090  0.0221
 0.2723  0.5873  0.0307  0.0128  0.0027  0.0034  0.0349  0.0050  0.0361  0.0148
 0.0011  0.0008  0.9919  0.0008  0.0010  0.0001  0.0006  0.0006  0.0027  0.0005
 0.0289  0.0239  0.0684  0.0059  0.0033  0.0011  0.6969  0.0077  0.1599  0.0041
[torch.cuda.FloatTensor of size 16x10 (GPU 1)]
, 
 0
 6
 2
 3
 6
 2
 4
 2
 6
 0
 7
 2
 8
 1
 2
 6
[torch.cuda.LongTensor of size 16 (GPU 1)]
, Variable containing:
 0
 2
 2
 3
 8
 2
 5
 2
 2
 0
 7
 2
 9
 0
 2
 6
[torch.cuda.LongTensor of size 16 (GPU 1)]
)
671/960 correct, 0.699%, avg loss: 4.89165655772
(854, 973)
Epoch: 16, Step: 7800, Train Loss: 0.81, Val Loss: 0.04, Val acc: 0.878
Param Norm1: 76820.60, grad Norm1: 103.32, Param Norm12: 105.37, grad Norm2: 1.00
(976, 973)
Epoch: 16, Step: 7900, Train Loss: 0.63, Val Loss: 0.00, Val acc: 1.003
Param Norm1: 77167.76, grad Norm1: 108.33, Param Norm12: 105.88, grad Norm2: 1.00
(976, 973)
Epoch: 16, Step: 8000, Train Loss: 0.70, Val Loss: 0.01, Val acc: 1.003
Param Norm1: 77524.60, grad Norm1: 118.91, Param Norm12: 106.38, grad Norm2: 1.00
(976, 973)
Epoch: 16, Step: 8100, Train Loss: 0.72, Val Loss: 0.00, Val acc: 1.003
Param Norm1: 77929.79, grad Norm1: 119.24, Param Norm12: 106.94, grad Norm2: 1.00
(671, 973)
Epoch: 16, Step: 8200, Train Loss: 0.61, Val Loss: 0.10, Val acc: 0.690
Param Norm1: 78311.51, grad Norm1: 84.87, Param Norm12: 107.45, grad Norm2: 1.00
Evaluating on training set
Processed 0 batches
(Variable containing:
 0.0079  0.0036  0.0196  0.0014  0.0012  0.0003  0.9360  0.0048  0.0230  0.0021
 0.0020  0.0019  0.0004  0.9927  0.0008  0.0001  0.0001  0.0005  0.0010  0.0003
 0.0429  0.0211  0.0253  0.0167  0.0040  0.0026  0.0265  0.0154  0.8394  0.0060
 0.0178  0.9636  0.0032  0.0022  0.0017  0.0013  0.0037  0.0022  0.0032  0.0010
 0.0039  0.9868  0.0014  0.0019  0.0007  0.0009  0.0010  0.0012  0.0018  0.0003
 0.0102  0.0072  0.0037  0.9695  0.0030  0.0004  0.0005  0.0004  0.0040  0.0009
 0.0004  0.0001  0.0000  0.0000  0.0000  0.9986  0.0001  0.0002  0.0002  0.0002
 0.0022  0.0017  0.0008  0.9903  0.0017  0.0002  0.0003  0.0005  0.0018  0.0006
 0.0336  0.9376  0.0043  0.0071  0.0018  0.0020  0.0041  0.0035  0.0047  0.0011
 0.9923  0.0012  0.0007  0.0011  0.0010  0.0013  0.0007  0.0005  0.0006  0.0007
 0.0120  0.0160  0.0022  0.9577  0.0031  0.0008  0.0004  0.0013  0.0056  0.0008
 0.0002  0.0010  0.0004  0.0001  0.0002  0.0001  0.0005  0.9965  0.0006  0.0004
 0.0003  0.0001  0.9983  0.0002  0.0001  0.0000  0.0003  0.0001  0.0004  0.0001
 0.0000  0.0000  0.0003  0.0000  0.0001  0.0000  0.0001  0.0000  0.0002  0.9992
 0.0042  0.9877  0.0011  0.0014  0.0006  0.0006  0.0011  0.0012  0.0016  0.0004
 0.0038  0.0046  0.0006  0.9858  0.0019  0.0002  0.0003  0.0005  0.0018  0.0005
[torch.cuda.FloatTensor of size 16x10 (GPU 1)]
, 
 6
 3
 8
 1
 1
 3
 5
 3
 1
 0
 3
 7
 2
 9
 1
 3
[torch.cuda.LongTensor of size 16 (GPU 1)]
, Variable containing:
 6
 3
 8
 1
 1
 3
 5
 3
 1
 0
 3
 7
 2
 9
 1
 3
[torch.cuda.LongTensor of size 16 (GPU 1)]
)
Processed 100 batches
Processed 200 batches
Processed 300 batches
Processed 400 batches
7366/7792 correct, 0.945%, avg loss: 0.521393018276
Evaluating on validation set
Processed 0 batches
(Variable containing:
 0.1571  0.0595  0.2217  0.0437  0.0309  0.0115  0.1019  0.1113  0.2343  0.0282
 0.0351  0.0399  0.0029  0.8999  0.0074  0.0019  0.0009  0.0017  0.0090  0.0013
 0.9187  0.0478  0.0058  0.0033  0.0032  0.0009  0.0037  0.0019  0.0134  0.0013
 0.0002  0.0001  0.9987  0.0001  0.0001  0.0000  0.0003  0.0001  0.0002  0.0002
 0.0337  0.9315  0.0025  0.0050  0.0017  0.0034  0.0055  0.0081  0.0058  0.0027
 0.0481  0.0177  0.3115  0.0043  0.0051  0.0015  0.3510  0.0057  0.2488  0.0063
 0.0072  0.0079  0.1562  0.0041  0.1348  0.0052  0.0135  0.0016  0.0141  0.6555
 0.0122  0.9717  0.0021  0.0036  0.0011  0.0015  0.0024  0.0023  0.0025  0.0007
 0.0002  0.0001  0.9981  0.0002  0.0001  0.0000  0.0003  0.0002  0.0006  0.0002
 0.8232  0.0513  0.0135  0.0075  0.0276  0.0050  0.0063  0.0027  0.0604  0.0025
 0.1406  0.0791  0.0706  0.0181  0.0055  0.0054  0.0300  0.0335  0.6139  0.0033
 0.0337  0.0121  0.1999  0.0057  0.0036  0.0010  0.6461  0.0044  0.0866  0.0069
 0.0004  0.0014  0.0006  0.0001  0.0003  0.0002  0.0011  0.9939  0.0010  0.0009
 0.0090  0.0032  0.0125  0.0012  0.0015  0.0002  0.9479  0.0023  0.0199  0.0022
 0.0020  0.0008  0.9855  0.0003  0.0006  0.0002  0.0045  0.0007  0.0046  0.0008
 0.0836  0.8792  0.0086  0.0083  0.0029  0.0029  0.0031  0.0046  0.0048  0.0020
[torch.cuda.FloatTensor of size 16x10 (GPU 1)]
, 
 8
 3
 0
 2
 1
 6
 9
 1
 2
 0
 8
 6
 7
 6
 2
 1
[torch.cuda.LongTensor of size 16 (GPU 1)]
, Variable containing:
 2
 3
 1
 2
 1
 2
 4
 1
 2
 0
 8
 4
 7
 6
 8
 1
[torch.cuda.LongTensor of size 16 (GPU 1)]
)
663/960 correct, 0.691%, avg loss: 5.7640550832
(976, 973)
Epoch: 17, Step: 8300, Train Loss: 0.80, Val Loss: 0.00, Val acc: 1.003
Param Norm1: 78582.08, grad Norm1: 166.84, Param Norm12: 107.80, grad Norm2: 1.00
(976, 973)
Epoch: 17, Step: 8400, Train Loss: 0.62, Val Loss: 0.00, Val acc: 1.003
Param Norm1: 78901.35, grad Norm1: 60.42, Param Norm12: 108.23, grad Norm2: 1.00
(915, 973)
Epoch: 17, Step: 8500, Train Loss: 0.68, Val Loss: 0.01, Val acc: 0.940
Param Norm1: 79308.44, grad Norm1: 110.27, Param Norm12: 108.75, grad Norm2: 1.00
(976, 973)
Epoch: 17, Step: 8600, Train Loss: 0.55, Val Loss: 0.00, Val acc: 1.003
Param Norm1: 79593.30, grad Norm1: 88.21, Param Norm12: 109.15, grad Norm2: 1.00
(915, 973)
Epoch: 17, Step: 8700, Train Loss: 0.59, Val Loss: 0.03, Val acc: 0.940
Param Norm1: 79933.16, grad Norm1: 106.31, Param Norm12: 109.60, grad Norm2: 1.00
Evaluating on training set
Processed 0 batches
(Variable containing:
 0.0004  0.9978  0.0003  0.0002  0.0001  0.0004  0.0002  0.0004  0.0003  0.0001
 0.8493  0.0354  0.0097  0.0628  0.0100  0.0026  0.0098  0.0047  0.0122  0.0034
 0.0001  0.0005  0.0006  0.0001  0.0003  0.0002  0.0004  0.9971  0.0004  0.0004
 0.0010  0.0018  0.9899  0.0006  0.0005  0.0001  0.0022  0.0003  0.0033  0.0002
 0.9986  0.0001  0.0001  0.0002  0.0000  0.0006  0.0001  0.0002  0.0000  0.0000
 0.0006  0.9975  0.0003  0.0002  0.0002  0.0002  0.0002  0.0003  0.0004  0.0001
 0.0001  0.0001  0.9987  0.0001  0.0002  0.0000  0.0001  0.0001  0.0004  0.0001
 0.0033  0.9913  0.0009  0.0009  0.0004  0.0006  0.0008  0.0008  0.0009  0.0002
 0.0287  0.9523  0.0040  0.0037  0.0013  0.0012  0.0033  0.0020  0.0029  0.0006
 0.0011  0.0023  0.0058  0.0003  0.0005  0.0000  0.9836  0.0005  0.0056  0.0003
 0.0018  0.0020  0.0003  0.9922  0.0014  0.0001  0.0002  0.0003  0.0013  0.0004
 0.0003  0.0022  0.0018  0.0014  0.0055  0.0005  0.0005  0.0000  0.0020  0.9857
 0.0054  0.9828  0.0016  0.0025  0.0008  0.0009  0.0022  0.0010  0.0021  0.0006
 0.0004  0.0010  0.0010  0.0001  0.0003  0.0004  0.0006  0.9946  0.0008  0.0006
 0.0033  0.0020  0.0101  0.0004  0.0004  0.0001  0.9737  0.0014  0.0080  0.0007
 0.0090  0.0031  0.0160  0.0014  0.0010  0.0002  0.9437  0.0012  0.0231  0.0014
[torch.cuda.FloatTensor of size 16x10 (GPU 1)]
, 
 1
 0
 7
 2
 0
 1
 2
 1
 1
 6
 3
 9
 1
 7
 6
 6
[torch.cuda.LongTensor of size 16 (GPU 1)]
, Variable containing:
 1
 0
 7
 2
 0
 1
 2
 1
 1
 6
 3
 9
 1
 7
 6
 8
[torch.cuda.LongTensor of size 16 (GPU 1)]
)
Processed 100 batches
Processed 200 batches
Processed 300 batches
Processed 400 batches
7433/7792 correct, 0.954%, avg loss: 0.450184864861
Evaluating on validation set
Processed 0 batches
(Variable containing:
 0.0024  0.0059  0.0025  0.0062  0.0962  0.0104  0.0026  0.0007  0.0051  0.8679
 0.8904  0.0151  0.0063  0.0471  0.0058  0.0011  0.0179  0.0022  0.0112  0.0028
 0.0004  0.0012  0.0007  0.0001  0.0005  0.0003  0.0004  0.9948  0.0009  0.0008
 0.0017  0.0008  0.0063  0.0112  0.1264  0.8466  0.0013  0.0002  0.0050  0.0005
 0.0018  0.0008  0.0004  0.9929  0.0011  0.0001  0.0002  0.0003  0.0018  0.0005
 0.0430  0.0348  0.0183  0.0010  0.0029  0.0011  0.0044  0.0040  0.8886  0.0018
 0.0017  0.0011  0.0013  0.9903  0.0021  0.0001  0.0002  0.0010  0.0016  0.0006
 0.0006  0.0006  0.9902  0.0007  0.0026  0.0002  0.0004  0.0006  0.0027  0.0013
 0.0002  0.0002  0.0003  0.0001  0.0003  0.0002  0.0003  0.9980  0.0004  0.0001
 0.0121  0.9763  0.0016  0.0031  0.0007  0.0007  0.0018  0.0018  0.0015  0.0005
 0.0092  0.0065  0.8701  0.0033  0.0038  0.0004  0.0559  0.0007  0.0450  0.0051
 0.0008  0.0016  0.0044  0.0044  0.0308  0.0011  0.0011  0.0001  0.0036  0.9522
 0.0095  0.0038  0.0066  0.0023  0.0015  0.0003  0.9295  0.0045  0.0385  0.0033
 0.0031  0.9901  0.0012  0.0013  0.0005  0.0005  0.0010  0.0008  0.0012  0.0002
 0.0001  0.0002  0.9978  0.0001  0.0005  0.0000  0.0002  0.0001  0.0007  0.0002
 0.0092  0.9708  0.0050  0.0042  0.0016  0.0011  0.0022  0.0014  0.0040  0.0004
[torch.cuda.FloatTensor of size 16x10 (GPU 1)]
, 
 9
 0
 7
 5
 3
 8
 3
 2
 7
 1
 2
 9
 6
 1
 2
 1
[torch.cuda.LongTensor of size 16 (GPU 1)]
, Variable containing:
 9
 0
 7
 4
 3
 8
 3
 2
 7
 1
 6
 9
 2
 1
 2
 0
[torch.cuda.LongTensor of size 16 (GPU 1)]
)
665/960 correct, 0.693%, avg loss: 7.05693743229
(915, 973)
Epoch: 18, Step: 8800, Train Loss: 0.68, Val Loss: 0.02, Val acc: 0.940
Param Norm1: 80225.42, grad Norm1: 103.19, Param Norm12: 109.99, grad Norm2: 1.00
(915, 973)
Epoch: 18, Step: 8900, Train Loss: 0.48, Val Loss: 0.02, Val acc: 0.940
Param Norm1: 80517.09, grad Norm1: 85.33, Param Norm12: 110.37, grad Norm2: 1.00
(854, 973)
Epoch: 18, Step: 9000, Train Loss: 0.55, Val Loss: 0.04, Val acc: 0.878
Param Norm1: 80825.27, grad Norm1: 117.33, Param Norm12: 110.78, grad Norm2: 1.00
(915, 973)
Epoch: 18, Step: 9100, Train Loss: 0.70, Val Loss: 0.03, Val acc: 0.940
Param Norm1: 81128.14, grad Norm1: 136.19, Param Norm12: 111.21, grad Norm2: 1.00
(976, 973)
Epoch: 18, Step: 9200, Train Loss: 0.55, Val Loss: 0.00, Val acc: 1.003
Param Norm1: 81497.39, grad Norm1: 93.29, Param Norm12: 111.68, grad Norm2: 0.95
Evaluating on training set
Processed 0 batches
(Variable containing:
 0.0004  0.0020  0.0011  0.0002  0.0017  0.0003  0.0012  0.9910  0.0011  0.0010
 0.0005  0.0007  0.0001  0.9970  0.0004  0.0000  0.0001  0.0001  0.0009  0.0001
 0.0006  0.0002  0.9971  0.0001  0.0003  0.0000  0.0006  0.0001  0.0008  0.0002
 0.0007  0.0004  0.0001  0.9974  0.0004  0.0000  0.0001  0.0001  0.0007  0.0002
 0.9863  0.0045  0.0003  0.0009  0.0020  0.0003  0.0025  0.0007  0.0024  0.0002
 0.0160  0.0088  0.0722  0.0063  0.0051  0.0027  0.0084  0.0046  0.8672  0.0086
 0.0014  0.0004  0.9935  0.0004  0.0008  0.0001  0.0010  0.0004  0.0016  0.0005
 0.9830  0.0065  0.0007  0.0039  0.0010  0.0001  0.0007  0.0003  0.0035  0.0002
 0.0018  0.0045  0.0020  0.0002  0.0013  0.0005  0.0013  0.9857  0.0020  0.0007
 0.0305  0.9431  0.0047  0.0088  0.0011  0.0008  0.0045  0.0017  0.0038  0.0008
 0.0009  0.0006  0.0003  0.9952  0.0006  0.0001  0.0002  0.0002  0.0016  0.0003
 0.0001  0.0002  0.0001  0.0001  0.0001  0.0006  0.0001  0.0000  0.0003  0.9984
 0.0007  0.9963  0.0004  0.0008  0.0002  0.0003  0.0004  0.0003  0.0005  0.0001
 0.0026  0.0071  0.0036  0.0003  0.0022  0.0009  0.0016  0.9774  0.0032  0.0011
 0.0012  0.0044  0.0009  0.0014  0.0007  0.0129  0.0028  0.0003  0.0108  0.9645
 0.0169  0.0032  0.9580  0.0015  0.0009  0.0006  0.0118  0.0021  0.0043  0.0006
[torch.cuda.FloatTensor of size 16x10 (GPU 1)]
, 
 7
 3
 2
 3
 0
 8
 2
 0
 7
 1
 3
 9
 1
 7
 9
 2
[torch.cuda.LongTensor of size 16 (GPU 1)]
, Variable containing:
 7
 3
 2
 3
 0
 8
 2
 0
 7
 1
 3
 9
 1
 7
 9
 2
[torch.cuda.LongTensor of size 16 (GPU 1)]
)
Processed 100 batches
Processed 200 batches
Processed 300 batches
Processed 400 batches
7439/7792 correct, 0.955%, avg loss: 0.468273324031
Evaluating on validation set
Processed 0 batches
(Variable containing:

Columns 0 to 5 
 9.8976e-01  4.4570e-03  4.3459e-04  9.8786e-04  4.8316e-04  1.0406e-04
 5.1496e-02  9.2264e-03  8.6826e-01  5.8909e-03  4.6021e-03  1.1286e-03
 2.5382e-03  4.0755e-03  1.6685e-03  1.9309e-04  1.1852e-03  3.9203e-04
 2.6705e-03  9.9239e-01  9.3844e-04  4.9871e-04  4.6470e-04  1.3108e-04
 1.2753e-04  5.3560e-05  9.9929e-01  3.4577e-05  1.1016e-04  9.3555e-06
 1.1434e-03  5.2465e-04  9.8369e-01  1.7590e-03  1.0636e-03  1.0068e-04
 1.5747e-03  5.3139e-03  1.0437e-03  1.8587e-03  1.2307e-02  2.5994e-02
 9.6585e-01  5.6439e-03  1.3377e-02  1.0915e-03  1.2453e-03  2.0434e-04
 1.1459e-02  4.4775e-03  2.4105e-02  1.8804e-03  1.1859e-03  4.1278e-04
 1.2535e-03  6.0781e-04  9.9225e-01  5.9909e-04  9.6848e-04  1.7618e-04
 8.4820e-01  8.4137e-02  3.7545e-03  4.0808e-02  4.3233e-03  1.4234e-03
 1.2962e-02  8.9082e-03  1.0101e-03  6.1086e-03  1.5044e-03  7.1682e-04
 3.3824e-04  1.2178e-04  9.9762e-01  2.9872e-04  5.6253e-04  2.8742e-05
 6.3234e-03  2.7082e-03  5.3441e-03  1.5715e-03  1.2800e-03  6.7213e-04
 6.5458e-02  9.9377e-03  4.9140e-02  5.4154e-02  2.2224e-01  2.5580e-01
 2.7325e-02  3.4649e-03  1.0688e-02  2.1208e-03  1.6344e-03  3.4108e-04

Columns 6 to 9 
 1.3499e-03  4.4846e-04  1.7290e-03  2.4299e-04
 1.8870e-02  2.3469e-03  3.5270e-02  2.9060e-03
 2.2401e-03  9.8495e-01  2.2472e-03  5.1085e-04
 7.6014e-04  6.9471e-04  1.3468e-03  1.0498e-04
 1.1558e-04  2.2018e-05  1.9140e-04  4.1550e-05
 4.4053e-03  4.4036e-04  6.5449e-03  3.2491e-04
 7.3907e-03  5.2046e-03  1.3114e-02  9.2620e-01
 4.4991e-03  2.3188e-04  6.0169e-03  1.8383e-03
 9.2297e-01  2.9227e-03  2.8906e-02  1.6815e-03
 1.5442e-03  6.1436e-04  1.5645e-03  4.2408e-04
 5.1131e-03  1.8637e-03  8.6157e-03  1.7586e-03
 1.4557e-03  1.3181e-03  9.6379e-01  2.2272e-03
 1.8890e-04  1.0509e-04  6.1362e-04  1.2652e-04
 2.1849e-03  1.4471e-03  9.7643e-01  2.0357e-03
 4.3307e-02  1.8432e-02  7.1103e-02  2.1043e-01
 9.2134e-01  2.0937e-03  2.8124e-02  2.8683e-03
[torch.cuda.FloatTensor of size 16x10 (GPU 1)]
, 
 0
 2
 7
 1
 2
 2
 9
 0
 6
 2
 0
 8
 2
 8
 5
 6
[torch.cuda.LongTensor of size 16 (GPU 1)]
, Variable containing:
 0
 2
 7
 0
 2
 2
 5
 2
 8
 2
 0
 8
 2
 0
 9
 6
[torch.cuda.LongTensor of size 16 (GPU 1)]
)
654/960 correct, 0.681%, avg loss: 6.5263000528
(915, 973)
Epoch: 19, Step: 9300, Train Loss: 0.78, Val Loss: 0.14, Val acc: 0.940
Param Norm1: 81721.10, grad Norm1: 69.96, Param Norm12: 111.99, grad Norm2: 1.00
(976, 973)
Epoch: 19, Step: 9400, Train Loss: 0.43, Val Loss: 0.00, Val acc: 1.003
Param Norm1: 82047.08, grad Norm1: 146.47, Param Norm12: 112.42, grad Norm2: 1.00
(976, 973)
Epoch: 19, Step: 9500, Train Loss: 0.58, Val Loss: 0.00, Val acc: 1.003
Param Norm1: 82383.30, grad Norm1: 120.41, Param Norm12: 112.86, grad Norm2: 1.00
(976, 973)
Epoch: 19, Step: 9600, Train Loss: 0.61, Val Loss: 0.00, Val acc: 1.003
Param Norm1: 82531.45, grad Norm1: 19.09, Param Norm12: 113.06, grad Norm2: 0.15
(976, 973)
Epoch: 19, Step: 9700, Train Loss: 0.66, Val Loss: 0.00, Val acc: 1.003
Param Norm1: 82742.40, grad Norm1: 68.35, Param Norm12: 113.36, grad Norm2: 0.64
Evaluating on training set
Processed 0 batches
(Variable containing:
 0.0141  0.9569  0.0035  0.0153  0.0009  0.0009  0.0018  0.0017  0.0045  0.0004
 0.1663  0.0289  0.3293  0.0263  0.0089  0.0073  0.2056  0.0631  0.1511  0.0131
 0.0052  0.0024  0.0022  0.0004  0.0007  0.0002  0.0010  0.0006  0.9864  0.0009
 0.0022  0.0034  0.0015  0.0008  0.0003  0.0002  0.0012  0.0006  0.9891  0.0007
 0.0152  0.9696  0.0013  0.0022  0.0005  0.0008  0.0043  0.0033  0.0018  0.0010
 0.0008  0.0008  0.0020  0.0003  0.0003  0.0000  0.9923  0.0003  0.0029  0.0003
 0.0023  0.0023  0.0037  0.0004  0.0005  0.0001  0.9776  0.0005  0.0121  0.0005
 0.0006  0.0009  0.0003  0.9965  0.0008  0.0000  0.0001  0.0002  0.0005  0.0002
 0.0143  0.0129  0.0045  0.0061  0.3310  0.1363  0.0117  0.0021  0.0197  0.4614
 0.9955  0.0019  0.0002  0.0004  0.0005  0.0001  0.0004  0.0003  0.0006  0.0001
 0.0002  0.9991  0.0001  0.0001  0.0000  0.0001  0.0001  0.0001  0.0001  0.0000
 0.0012  0.9957  0.0005  0.0007  0.0001  0.0002  0.0006  0.0004  0.0003  0.0001
 0.0009  0.9920  0.0010  0.0017  0.0003  0.0002  0.0023  0.0006  0.0008  0.0003
 0.0160  0.0039  0.0036  0.0008  0.0607  0.0007  0.0010  0.0013  0.0067  0.9052
 0.0016  0.0014  0.0005  0.9935  0.0006  0.0001  0.0003  0.0003  0.0015  0.0003
 0.0007  0.0017  0.9897  0.0002  0.0003  0.0002  0.0034  0.0008  0.0026  0.0005
[torch.cuda.FloatTensor of size 16x10 (GPU 1)]
, 
 1
 2
 8
 8
 1
 6
 6
 3
 9
 0
 1
 1
 1
 9
 3
 2
[torch.cuda.LongTensor of size 16 (GPU 1)]
, Variable containing:
 1
 0
 8
 8
 1
 6
 6
 3
 5
 0
 1
 1
 1
 9
 3
 2
[torch.cuda.LongTensor of size 16 (GPU 1)]
)
Processed 100 batches
Processed 200 batches
Processed 300 batches
Processed 400 batches
7452/7792 correct, 0.956%, avg loss: 0.426255054453
Evaluating on validation set
Processed 0 batches
(Variable containing:
 0.0025  0.0035  0.9664  0.0013  0.0015  0.0003  0.0088  0.0004  0.0144  0.0010
 0.0009  0.0024  0.9899  0.0004  0.0005  0.0002  0.0027  0.0005  0.0022  0.0004
 0.8099  0.1253  0.0107  0.0280  0.0030  0.0011  0.0115  0.0022  0.0071  0.0013
 0.0130  0.0126  0.8483  0.0035  0.0024  0.0017  0.0703  0.0120  0.0342  0.0019
 0.0005  0.0018  0.0004  0.9955  0.0006  0.0001  0.0002  0.0002  0.0005  0.0002
 0.4229  0.5070  0.0077  0.0320  0.0045  0.0015  0.0139  0.0023  0.0060  0.0021
 0.0150  0.0384  0.0037  0.9296  0.0053  0.0009  0.0005  0.0009  0.0048  0.0010
 0.5648  0.1941  0.0981  0.0594  0.0204  0.0032  0.0083  0.0040  0.0445  0.0031
 0.0001  0.0001  0.9993  0.0000  0.0001  0.0000  0.0001  0.0000  0.0001  0.0001
 0.0032  0.0025  0.0021  0.0104  0.0013  0.0004  0.0006  0.0009  0.9764  0.0020
 0.0023  0.9929  0.0005  0.0014  0.0002  0.0004  0.0005  0.0009  0.0005  0.0003
 0.0068  0.0809  0.0423  0.8561  0.0022  0.0027  0.0002  0.0009  0.0072  0.0006
 0.0387  0.0352  0.4913  0.0042  0.0036  0.0028  0.2404  0.0062  0.1715  0.0062
 0.0159  0.0875  0.0097  0.8281  0.0064  0.0023  0.0071  0.0060  0.0343  0.0029
 0.0001  0.0001  0.9989  0.0000  0.0002  0.0000  0.0001  0.0000  0.0003  0.0001
 0.9790  0.0118  0.0016  0.0016  0.0012  0.0002  0.0011  0.0004  0.0025  0.0005
[torch.cuda.FloatTensor of size 16x10 (GPU 1)]
, 
 2
 2
 0
 2
 3
 1
 3
 0
 2
 8
 1
 3
 2
 3
 2
 0
[torch.cuda.LongTensor of size 16 (GPU 1)]
, Variable containing:
 6
 2
 1
 2
 0
 1
 3
 1
 2
 2
 0
 3
 8
 1
 2
 0
[torch.cuda.LongTensor of size 16 (GPU 1)]
)
675/960 correct, 0.703%, avg loss: 7.5834664921
